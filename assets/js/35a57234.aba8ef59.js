"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2351],{726:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"graphql/overview","title":"GraphQL","description":"Balda.js provides built-in support for GraphQL through integration with GraphQL Yoga. GraphQL support is optional and requires installing peer dependencies.","source":"@site/docs/graphql/overview.md","sourceDirName":"graphql","slug":"/graphql/overview","permalink":"/balda-js/docs/graphql/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda-js/tree/main/docs/docs/graphql/overview.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docs","previous":{"title":"Error Handling","permalink":"/balda-js/docs/core-concepts/error-handling"},"next":{"title":"Plugins Overview","permalink":"/balda-js/docs/plugins/overview"}}');var a=r(4848),t=r(8453);const i={sidebar_position:1},o="GraphQL",l={},d=[{value:"Installation",id:"installation",level:2},{value:"Basic Setup",id:"basic-setup",level:2},{value:"Configuration Options",id:"configuration-options",level:2},{value:"Schema Configuration",id:"schema-configuration",level:3},{value:"Yoga Options",id:"yoga-options",level:3},{value:"Dynamic Schema Building",id:"dynamic-schema-building",level:2},{value:"Adding Type Definitions",id:"adding-type-definitions",level:3},{value:"Adding Resolvers",id:"adding-resolvers",level:3},{value:"Typed Context",id:"typed-context",level:2},{value:"Extending the Context",id:"extending-the-context",level:3},{value:"Using Typed Context in Resolvers",id:"using-typed-context-in-resolvers",level:3},{value:"Providing Context",id:"providing-context",level:3},{value:"Resolver Function Signature",id:"resolver-function-signature",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"GraphiQL Playground",id:"graphiql-playground",level:2},{value:"Lazy Loading",id:"lazy-loading",level:2},{value:"Runtime Support",id:"runtime-support",level:2},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"graphql",children:"GraphQL"})}),"\n",(0,a.jsxs)(n.p,{children:["Balda.js provides built-in support for GraphQL through integration with ",(0,a.jsx)(n.a,{href:"https://the-guild.dev/graphql/yoga-server",children:"GraphQL Yoga"}),". GraphQL support is optional and requires installing peer dependencies."]}),"\n",(0,a.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,a.jsx)(n.p,{children:"First, install the required peer dependencies:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm install graphql graphql-yoga\n"})}),"\n",(0,a.jsx)(n.p,{children:"or with yarn:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"yarn add graphql graphql-yoga\n"})}),"\n",(0,a.jsx)(n.h2,{id:"basic-setup",children:"Basic Setup"}),"\n",(0,a.jsxs)(n.p,{children:["Enable GraphQL by passing a ",(0,a.jsx)(n.code,{children:"graphql"})," configuration object when creating your server:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import { Server } from 'balda-js';\n\nconst server = new Server({\n  port: 3000,\n  graphql: {\n    schema: {\n      typeDefs: `\n        type Query {\n          hello: String\n        }\n      `,\n      resolvers: {\n        Query: {\n          hello: () => 'Hello from GraphQL!',\n        },\n      },\n    },\n  },\n});\n\nawait server.listen();\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Your GraphQL endpoint will be available at ",(0,a.jsx)(n.code,{children:"/graphql"})," by default."]}),"\n",(0,a.jsx)(n.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,a.jsx)(n.h3,{id:"schema-configuration",children:"Schema Configuration"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"schema"})," option accepts type definitions and resolvers:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  graphql: {\n    schema: {\n      typeDefs: `\n        type User {\n          id: ID!\n          name: String!\n          email: String!\n        }\n\n        type Query {\n          users: [User!]!\n          user(id: ID!): User\n        }\n\n        type Mutation {\n          createUser(name: String!, email: String!): User!\n        }\n      `,\n      resolvers: {\n        Query: {\n          users: () => {\n            // Fetch users from database\n            return [];\n          },\n          user: (parent, args) => {\n            // Fetch user by ID\n            return { id: args.id, name: 'John', email: 'john@example.com' };\n          },\n        },\n        Mutation: {\n          createUser: (parent, args) => {\n            // Create user in database\n            return { id: '1', name: args.name, email: args.email };\n          },\n        },\n      },\n    },\n  },\n});\n"})}),"\n",(0,a.jsx)(n.h3,{id:"yoga-options",children:"Yoga Options"}),"\n",(0,a.jsx)(n.p,{children:"You can pass additional options to GraphQL Yoga:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  graphql: {\n    schema: {\n      typeDefs: `...`,\n      resolvers: {},\n    },\n    yogaOptions: {\n      graphqlEndpoint: '/graphql',\n      landingPage: true,\n      maskedErrors: false,\n      cors: {\n        origin: '*',\n        credentials: true,\n      },\n    },\n  },\n});\n"})}),"\n",(0,a.jsxs)(n.p,{children:["For a full list of Yoga options, see the ",(0,a.jsx)(n.a,{href:"https://the-guild.dev/graphql/yoga-server/docs",children:"GraphQL Yoga documentation"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"dynamic-schema-building",children:"Dynamic Schema Building"}),"\n",(0,a.jsx)(n.p,{children:"Balda.js provides methods to add type definitions and resolvers dynamically:"}),"\n",(0,a.jsx)(n.h3,{id:"adding-type-definitions",children:"Adding Type Definitions"}),"\n",(0,a.jsxs)(n.p,{children:["Use ",(0,a.jsx)(n.code,{children:"addTypeDef()"})," to add type definitions after server initialization:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({ graphql: {} });\n\n// Add type definitions\nserver.graphql.addTypeDef(`\n  type Book {\n    id: ID!\n    title: String!\n    author: String!\n  }\n`);\n\nserver.graphql.addTypeDef(`\n  extend type Query {\n    books: [Book!]!\n    book(id: ID!): Book\n  }\n`);\n"})}),"\n",(0,a.jsx)(n.p,{children:"You can also add multiple type definitions at once:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"server.graphql.addTypeDef([\n  `type Author { id: ID!, name: String! }`,\n  `type Publisher { id: ID!, name: String! }`,\n]);\n"})}),"\n",(0,a.jsx)(n.h3,{id:"adding-resolvers",children:"Adding Resolvers"}),"\n",(0,a.jsxs)(n.p,{children:["Use ",(0,a.jsx)(n.code,{children:"addResolver()"})," to add resolvers dynamically:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Add resolvers for a specific type\nserver.graphql.addResolver('Query', {\n  books: () => {\n    return [\n      { id: '1', title: 'GraphQL Basics', author: 'John Doe' },\n    ];\n  },\n  book: (parent, args) => {\n    return { id: args.id, title: 'Book Title', author: 'Author' };\n  },\n});\n\nserver.graphql.addResolver('Mutation', {\n  createBook: (parent, args) => {\n    return { id: '1', title: args.title, author: args.author };\n  },\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:"You can also add full resolver objects:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"server.graphql.addResolver({\n  Query: {\n    users: () => [],\n  },\n  Mutation: {\n    createUser: (parent, args) => args,\n  },\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:"For custom types:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"server.graphql.addResolver('Book', {\n  author: (parent) => {\n    // Resolve nested author field\n    return { id: '1', name: parent.author };\n  },\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"typed-context",children:"Typed Context"}),"\n",(0,a.jsxs)(n.p,{children:["Balda.js exports a ",(0,a.jsx)(n.code,{children:"GraphQLContext"})," interface that you can extend to provide type-safe context in your resolvers."]}),"\n",(0,a.jsx)(n.h3,{id:"extending-the-context",children:"Extending the Context"}),"\n",(0,a.jsx)(n.p,{children:"Use TypeScript's module augmentation to extend the context type:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import type { GraphQLContext } from 'balda-js';\n\n// Define your custom context properties\ninterface User {\n  id: string;\n  name: string;\n  email: string;\n}\n\ninterface Database {\n  users: Map<string, User>;\n}\n\n// Extend the GraphQLContext interface\ndeclare module 'balda-js' {\n  interface GraphQLContext {\n    user?: User;\n    db: Database;\n    req: Request;\n  }\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"using-typed-context-in-resolvers",children:"Using Typed Context in Resolvers"}),"\n",(0,a.jsx)(n.p,{children:"Once extended, your resolvers will have full type safety:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"server.graphql.addResolver('Query', {\n  me: (parent, args, context) => {\n    // context.user is now fully typed!\n    if (!context.user) {\n      throw new Error('Not authenticated');\n    }\n    return context.user;\n  },\n  users: (parent, args, context) => {\n    // context.db is typed as Database\n    return Array.from(context.db.users.values());\n  },\n});\n"})}),"\n",(0,a.jsx)(n.h3,{id:"providing-context",children:"Providing Context"}),"\n",(0,a.jsxs)(n.p,{children:["Pass context values through the ",(0,a.jsx)(n.code,{children:"yogaOptions"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"const db: Database = {\n  users: new Map(),\n};\n\nconst server = new Server({\n  graphql: {\n    schema: {\n      typeDefs: `...`,\n      resolvers: {},\n    },\n    yogaOptions: {\n      context: async ({ request }) => {\n        // Extract user from request headers\n        const token = request.headers.get('authorization');\n        const user = token ? await verifyToken(token) : undefined;\n\n        return {\n          user,\n          db,\n          req: request,\n        };\n      },\n    },\n  },\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"resolver-function-signature",children:"Resolver Function Signature"}),"\n",(0,a.jsx)(n.p,{children:"All resolver functions follow the standard GraphQL signature:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"type GraphQLResolverFunction<TContext = GraphQLContext> = (\n  parent: unknown,\n  args: Record<string, unknown>,\n  context: TContext,\n  info: unknown\n) => unknown | Promise<unknown>;\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"parent"}),": The result of the parent resolver (for nested fields)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"args"}),": The arguments provided to the field"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"context"}),": The shared context object (typed via module augmentation)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"info"}),": GraphQL execution info (field name, parent type, etc.)"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Resolvers can return values synchronously or return a Promise for async operations."}),"\n",(0,a.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,a.jsx)(n.p,{children:"GraphQL Yoga automatically catches errors thrown in resolvers:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"server.graphql.addResolver('Query', {\n  user: async (parent, args, context) => {\n    const user = await context.db.users.get(args.id);\n\n    if (!user) {\n      throw new Error('User not found');\n    }\n\n    return user;\n  },\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:"For custom error handling, use Yoga's error masking options:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  graphql: {\n    yogaOptions: {\n      maskedErrors: {\n        maskError: (error, message, isDev) => {\n          if (error.message.includes('INTERNAL')) {\n            return new Error('Internal server error');\n          }\n          return error;\n        },\n      },\n    },\n  },\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"graphiql-playground",children:"GraphiQL Playground"}),"\n",(0,a.jsx)(n.p,{children:"GraphQL Yoga includes a built-in GraphiQL playground. Access it by navigating to your GraphQL endpoint in a browser:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"http://localhost:3000/graphql\n"})}),"\n",(0,a.jsx)(n.p,{children:"You can customize or disable the playground:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  graphql: {\n    yogaOptions: {\n      // Enable/disable playground\n      landingPage: true,\n\n      // Or customize it\n      graphiql: {\n        title: 'My GraphQL API',\n        defaultQuery: `\n          query {\n            hello\n          }\n        `,\n      },\n    },\n  },\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"lazy-loading",children:"Lazy Loading"}),"\n",(0,a.jsx)(n.p,{children:"GraphQL dependencies are loaded lazily when the first GraphQL request is made. This means:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"If GraphQL is not configured, the dependencies are never loaded"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"If the GraphQL peer dependencies are not installed and GraphQL is enabled, you'll receive a clear error message:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"GraphQL is enabled but 'graphql-yoga' is not installed.\nInstall it with: npm install graphql graphql-yoga\n"})}),"\n",(0,a.jsx)(n.h2,{id:"runtime-support",children:"Runtime Support"}),"\n",(0,a.jsx)(n.p,{children:"GraphQL support works across all Balda.js runtimes:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u2705 Node.js"}),"\n",(0,a.jsx)(n.li,{children:"\u2705 Bun"}),"\n",(0,a.jsx)(n.li,{children:"\u2705 Deno"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"The implementation uses dynamic imports to load GraphQL Yoga only when needed, ensuring optimal performance across all platforms."}),"\n",(0,a.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Explore ",(0,a.jsx)(n.a,{href:"https://the-guild.dev/graphql/yoga-server",children:"GraphQL Yoga documentation"})]}),"\n",(0,a.jsxs)(n.li,{children:["Learn about ",(0,a.jsx)(n.a,{href:"https://graphql.org/learn/schema/",children:"GraphQL schema design"})]}),"\n",(0,a.jsxs)(n.li,{children:["Check out ",(0,a.jsx)(n.a,{href:"https://graphql.org/learn/best-practices/",children:"GraphQL best practices"})]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>o});var s=r(6540);const a={},t=s.createContext(a);function i(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);