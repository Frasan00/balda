"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6201],{3392:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>t,default:()=>a,frontMatter:()=>c,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"cache/providers","title":"Cache Providers","description":"Balda supports three types of cache backends: the built-in in-memory provider, a Redis-backed provider, and any custom provider you implement.","source":"@site/docs/cache/providers.md","sourceDirName":"cache","slug":"/cache/providers","permalink":"/balda/docs/cache/providers","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda/tree/main/docs/docs/cache/providers.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docs","previous":{"title":"Caching Overview","permalink":"/balda/docs/cache/overview"},"next":{"title":"Cache Keys","permalink":"/balda/docs/cache/cache-keys"}}');var d=n(4848),i=n(8453);const c={sidebar_position:2},t="Cache Providers",o={},l=[{value:"Memory Provider (default)",id:"memory-provider-default",level:2},{value:"Redis Provider",id:"redis-provider",level:2},{value:"Redis Connection Options",id:"redis-connection-options",level:3},{value:"Using a Connection URL",id:"using-a-connection-url",level:3},{value:"Using a Pre-configured Instance",id:"using-a-pre-configured-instance",level:3},{value:"Custom Provider",id:"custom-provider",level:2},{value:"<code>CacheProvider</code> Interface",id:"cacheprovider-interface",level:3}];function h(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(r.header,{children:(0,d.jsx)(r.h1,{id:"cache-providers",children:"Cache Providers"})}),"\n",(0,d.jsx)(r.p,{children:"Balda supports three types of cache backends: the built-in in-memory provider, a Redis-backed provider, and any custom provider you implement."}),"\n",(0,d.jsx)(r.h2,{id:"memory-provider-default",children:"Memory Provider (default)"}),"\n",(0,d.jsxs)(r.p,{children:["The ",(0,d.jsx)(r.code,{children:"MemoryCacheProvider"})," stores entries in a ",(0,d.jsx)(r.code,{children:"Map"})," inside the current process. It requires no dependencies and is the default when ",(0,d.jsx)(r.code,{children:"provider"})," is omitted."]}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-ts",children:"import { Server } from 'balda';\n\nconst server = new Server({\n  cache: {\n    provider: 'memory',\n    defaultTtl: 120,\n  },\n});\n"})}),"\n",(0,d.jsx)(r.admonition,{type:"info",children:(0,d.jsxs)(r.p,{children:["The memory provider is scoped to a single process. Entries are lost on restart and are ",(0,d.jsx)(r.strong,{children:"not shared"})," across multiple instances. Use Redis for production deployments."]})}),"\n",(0,d.jsx)(r.h2,{id:"redis-provider",children:"Redis Provider"}),"\n",(0,d.jsxs)(r.p,{children:["The ",(0,d.jsx)(r.code,{children:"RedisCacheProvider"})," uses ",(0,d.jsx)(r.a,{href:"https://github.com/redis/ioredis",children:"ioredis"})," as a peer dependency. Install it first:"]}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-bash",children:"npm install ioredis\n"})}),"\n",(0,d.jsx)(r.p,{children:"Then configure the server:"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-ts",children:"import { Server } from 'balda';\n\nconst server = new Server({\n  cache: {\n    provider: 'redis',\n    redis: {\n      host: 'localhost',\n      port: 6379,\n      password: 'secret',\n    },\n  },\n});\n"})}),"\n",(0,d.jsx)(r.h3,{id:"redis-connection-options",children:"Redis Connection Options"}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"Option"}),(0,d.jsx)(r.th,{children:"Type"}),(0,d.jsx)(r.th,{children:"Default"}),(0,d.jsx)(r.th,{children:"Description"})]})}),(0,d.jsxs)(r.tbody,{children:[(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"host"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"string"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"'localhost'"})}),(0,d.jsx)(r.td,{children:"Redis server hostname"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"port"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"number"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"6379"})}),(0,d.jsx)(r.td,{children:"Redis server port"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"password"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"string"})}),(0,d.jsx)(r.td,{children:"\u2014"}),(0,d.jsx)(r.td,{children:"Redis AUTH password"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"db"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"number"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"0"})}),(0,d.jsx)(r.td,{children:"Redis database index"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"keyPrefix"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"string"})}),(0,d.jsx)(r.td,{children:"\u2014"}),(0,d.jsx)(r.td,{children:"Prefix for all Redis keys"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"url"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"string"})}),(0,d.jsx)(r.td,{children:"\u2014"}),(0,d.jsx)(r.td,{children:"Full Redis URL (overrides host/port/password/db)"})]})]})]}),"\n",(0,d.jsx)(r.h3,{id:"using-a-connection-url",children:"Using a Connection URL"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-ts",children:"const server = new Server({\n  cache: {\n    provider: 'redis',\n    redis: {\n      url: 'redis://:password@redis-host:6379/0',\n    },\n  },\n});\n"})}),"\n",(0,d.jsx)(r.h3,{id:"using-a-pre-configured-instance",children:"Using a Pre-configured Instance"}),"\n",(0,d.jsxs)(r.p,{children:["You can also pass a ",(0,d.jsx)(r.code,{children:"RedisCacheProvider"})," instance directly, for example to share a connection or configure advanced ioredis options:"]}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-ts",children:"import { Server } from 'balda';\nimport { RedisCacheProvider } from 'balda/cache';\n\nconst redisProvider = new RedisCacheProvider({\n  host: process.env.REDIS_HOST,\n  port: Number(process.env.REDIS_PORT),\n  password: process.env.REDIS_PASSWORD,\n  keyPrefix: 'myapp:',\n});\n\nconst server = new Server({\n  cache: { provider: redisProvider },\n});\n"})}),"\n",(0,d.jsx)(r.h2,{id:"custom-provider",children:"Custom Provider"}),"\n",(0,d.jsxs)(r.p,{children:["Implement the ",(0,d.jsx)(r.code,{children:"CacheProvider"})," interface to use any storage backend (Memcached, DynamoDB, Upstash, etc.)."]}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-ts",children:"import type { CacheProvider } from 'balda';\n\nclass MyCustomProvider implements CacheProvider {\n  async get(key: string): Promise<string | null> { /* ... */ }\n  async set(key: string, value: string, ttlSeconds: number): Promise<void> { /* ... */ }\n  async del(key: string): Promise<boolean> { /* ... */ }\n  async delMany(keys: string[]): Promise<number> { /* ... */ }\n  async addToSet(key: string, members: string[], ttlSeconds?: number): Promise<void> { /* ... */ }\n  async getSetMembers(key: string): Promise<string[]> { /* ... */ }\n  async acquireLock(key: string, ttlMs: number): Promise<boolean> { /* ... */ }\n  async releaseLock(key: string): Promise<void> { /* ... */ }\n  async *scan(pattern: string): AsyncIterable<string[]> { /* ... */ }\n  async disconnect(): Promise<void> { /* ... */ }\n}\n\nconst server = new Server({\n  cache: { provider: new MyCustomProvider() },\n});\n"})}),"\n",(0,d.jsxs)(r.h3,{id:"cacheprovider-interface",children:[(0,d.jsx)(r.code,{children:"CacheProvider"})," Interface"]}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"Method"}),(0,d.jsx)(r.th,{children:"Signature"}),(0,d.jsx)(r.th,{children:"Description"})]})}),(0,d.jsxs)(r.tbody,{children:[(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"get"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"(key) \u2192 Promise<string | null>"})}),(0,d.jsx)(r.td,{children:"Fetch a raw string by key"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"set"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"(key, value, ttlSeconds) \u2192 Promise<void>"})}),(0,d.jsx)(r.td,{children:"Store with TTL"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"del"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"(key) \u2192 Promise<boolean>"})}),(0,d.jsxs)(r.td,{children:["Delete one key; returns ",(0,d.jsx)(r.code,{children:"true"})," if it existed"]})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"delMany"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"(keys) \u2192 Promise<number>"})}),(0,d.jsx)(r.td,{children:"Bulk delete; returns count deleted"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"addToSet"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"(key, members, ttl?) \u2192 Promise<void>"})}),(0,d.jsx)(r.td,{children:"Add to a set (used for tag tracking)"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"getSetMembers"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"(key) \u2192 Promise<string[]>"})}),(0,d.jsx)(r.td,{children:"Read all set members"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"acquireLock"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"(key, ttlMs) \u2192 Promise<boolean>"})}),(0,d.jsxs)(r.td,{children:["NX-style lock; ",(0,d.jsx)(r.code,{children:"true"})," if acquired"]})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"releaseLock"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"(key) \u2192 Promise<void>"})}),(0,d.jsx)(r.td,{children:"Release a lock"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"scan"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"(pattern) \u2192 AsyncIterable<string[]>"})}),(0,d.jsx)(r.td,{children:"Cursor-scan by glob pattern"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"disconnect"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"() \u2192 Promise<void>"})}),(0,d.jsx)(r.td,{children:"Clean up connections"})]})]})]})]})}function a(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,d.jsx)(r,{...e,children:(0,d.jsx)(h,{...e})}):h(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>c,x:()=>t});var s=n(6540);const d={},i=s.createContext(d);function c(e){const r=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:c(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);