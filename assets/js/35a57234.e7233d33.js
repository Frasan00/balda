"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2351],{726:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>t,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"graphql/overview","title":"GraphQL","description":"Balda provides built-in support for GraphQL through integration with Apollo Server. GraphQL support is optional and requires installing peer dependencies.","source":"@site/docs/graphql/overview.md","sourceDirName":"graphql","slug":"/graphql/overview","permalink":"/balda/docs/graphql/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda/tree/main/docs/docs/graphql/overview.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docs","previous":{"title":"WebSockets","permalink":"/balda/docs/websockets/overview"},"next":{"title":"Plugins Overview","permalink":"/balda/docs/plugins/overview"}}');var i=r(4848),l=r(8453);const o={sidebar_position:1},a="GraphQL",t={},d=[{value:"Installation",id:"installation",level:2},{value:"Basic Setup",id:"basic-setup",level:2},{value:"Configuration Options",id:"configuration-options",level:2},{value:"Schema Configuration",id:"schema-configuration",level:3},{value:"Apollo Server Options",id:"apollo-server-options",level:3},{value:"Dynamic Schema Building",id:"dynamic-schema-building",level:2},{value:"Adding Type Definitions",id:"adding-type-definitions",level:3},{value:"Adding Resolvers",id:"adding-resolvers",level:3},{value:"Typed Context",id:"typed-context",level:2},{value:"Extending the Context",id:"extending-the-context",level:3},{value:"Using Typed Context in Resolvers",id:"using-typed-context-in-resolvers",level:3},{value:"Providing Context",id:"providing-context",level:3},{value:"Resolver Function Signature",id:"resolver-function-signature",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Apollo Sandbox",id:"apollo-sandbox",level:2},{value:"Enabling Apollo Sandbox",id:"enabling-apollo-sandbox",level:3},{value:"Using the Sandbox UI",id:"using-the-sandbox-ui",level:3},{value:"1. <strong>Interactive Query Editor</strong>",id:"1-interactive-query-editor",level:4},{value:"2. <strong>Schema Explorer</strong>",id:"2-schema-explorer",level:4},{value:"3. <strong>Query Variables</strong>",id:"3-query-variables",level:4},{value:"4. <strong>Request Headers</strong>",id:"4-request-headers",level:4},{value:"5. <strong>Operation History</strong>",id:"5-operation-history",level:4},{value:"6. <strong>Response Viewer</strong>",id:"6-response-viewer",level:4},{value:"Example: Testing with Sandbox UI",id:"example-testing-with-sandbox-ui",level:3},{value:"Production Configuration",id:"production-configuration",level:3},{value:"Troubleshooting Sandbox Issues",id:"troubleshooting-sandbox-issues",level:3},{value:"Alternative: Disable Landing Page",id:"alternative-disable-landing-page",level:3},{value:"Lazy Loading",id:"lazy-loading",level:2},{value:"Runtime Support",id:"runtime-support",level:2},{value:"Advanced Features",id:"advanced-features",level:2},{value:"Plugins",id:"plugins",level:3},{value:"Subscriptions",id:"subscriptions",level:3},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"graphql",children:"GraphQL"})}),"\n",(0,i.jsxs)(n.p,{children:["Balda provides built-in support for GraphQL through integration with ",(0,i.jsx)(n.a,{href:"https://www.apollographql.com/docs/apollo-server/",children:"Apollo Server"}),". GraphQL support is optional and requires installing peer dependencies."]}),"\n",(0,i.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,i.jsx)(n.p,{children:"First, install the required peer dependencies:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install @apollo/server @graphql-tools/schema graphql\n"})}),"\n",(0,i.jsx)(n.p,{children:"or with yarn:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"yarn add @apollo/server @graphql-tools/schema graphql\n"})}),"\n",(0,i.jsx)(n.h2,{id:"basic-setup",children:"Basic Setup"}),"\n",(0,i.jsxs)(n.p,{children:["Enable GraphQL by passing a ",(0,i.jsx)(n.code,{children:"graphql"})," configuration object when creating your server:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'import { Server } from "balda";\n\nconst server = new Server({\n  port: 3000,\n  graphql: {\n    schema: {\n      typeDefs: `\n        type Query {\n          hello: String\n        }\n      `,\n      resolvers: {\n        Query: {\n          hello: () => "Hello from GraphQL!",\n        },\n      },\n    },\n  },\n});\n\nawait server.listen();\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Your GraphQL endpoint will be available at ",(0,i.jsx)(n.code,{children:"/graphql"})," by default."]}),"\n",(0,i.jsx)(n.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,i.jsx)(n.h3,{id:"schema-configuration",children:"Schema Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"schema"})," option accepts type definitions and resolvers:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const server = new Server({\n  graphql: {\n    schema: {\n      typeDefs: `\n        type User {\n          id: ID!\n          name: String!\n          email: String!\n        }\n\n        type Query {\n          users: [User!]!\n          user(id: ID!): User\n        }\n\n        type Mutation {\n          createUser(name: String!, email: String!): User!\n        }\n      `,\n      resolvers: {\n        Query: {\n          users: () => {\n            // Fetch users from database\n            return [];\n          },\n          user: (parent, args) => {\n            // Fetch user by ID\n            return { id: args.id, name: "John", email: "john@example.com" };\n          },\n        },\n        Mutation: {\n          createUser: (parent, args) => {\n            // Create user in database\n            return { id: "1", name: args.name, email: args.email };\n          },\n        },\n      },\n    },\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"apollo-server-options",children:"Apollo Server Options"}),"\n",(0,i.jsx)(n.p,{children:"You can pass additional options to Apollo Server:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const server = new Server({\n  graphql: {\n    schema: {\n      typeDefs: `...`,\n      resolvers: {},\n    },\n    apolloOptions: {\n      introspection: true,\n      includeStacktraceInErrorResponses: false,\n      csrfPrevention: true,\n      cache: "bounded",\n      plugins: [\n        // Add your Apollo Server plugins here\n      ],\n    },\n  },\n});\n'})}),"\n",(0,i.jsxs)(n.p,{children:["For a full list of Apollo Server options, see the ",(0,i.jsx)(n.a,{href:"https://www.apollographql.com/docs/apollo-server/api/apollo-server",children:"Apollo Server documentation"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"dynamic-schema-building",children:"Dynamic Schema Building"}),"\n",(0,i.jsx)(n.p,{children:"Balda provides methods to add type definitions and resolvers dynamically:"}),"\n",(0,i.jsx)(n.h3,{id:"adding-type-definitions",children:"Adding Type Definitions"}),"\n",(0,i.jsxs)(n.p,{children:["Use ",(0,i.jsx)(n.code,{children:"addTypeDef()"})," to add type definitions after server initialization:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({ graphql: {} });\n\n// Add type definitions\nserver.graphql.addTypeDef(`\n  type Book {\n    id: ID!\n    title: String!\n    author: String!\n  }\n`);\n\nserver.graphql.addTypeDef(`\n  extend type Query {\n    books: [Book!]!\n    book(id: ID!): Book\n  }\n`);\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can also add multiple type definitions at once:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"server.graphql.addTypeDef([\n  `type Author { id: ID!, name: String! }`,\n  `type Publisher { id: ID!, name: String! }`,\n]);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"adding-resolvers",children:"Adding Resolvers"}),"\n",(0,i.jsxs)(n.p,{children:["Use ",(0,i.jsx)(n.code,{children:"addResolver()"})," to add resolvers dynamically:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// Add resolvers for a specific type\nserver.graphql.addResolver("Query", {\n  books: () => {\n    return [{ id: "1", title: "GraphQL Basics", author: "John Doe" }];\n  },\n  book: (parent, args) => {\n    return { id: args.id, title: "Book Title", author: "Author" };\n  },\n});\n\nserver.graphql.addResolver("Mutation", {\n  createBook: (parent, args) => {\n    return { id: "1", title: args.title, author: args.author };\n  },\n});\n'})}),"\n",(0,i.jsx)(n.p,{children:"You can also add full resolver objects:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"server.graphql.addResolver({\n  Query: {\n    users: () => [],\n  },\n  Mutation: {\n    createUser: (parent, args) => args,\n  },\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:"For custom types:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'server.graphql.addResolver("Book", {\n  author: (parent) => {\n    // Resolve nested author field\n    return { id: "1", name: parent.author };\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"typed-context",children:"Typed Context"}),"\n",(0,i.jsxs)(n.p,{children:["Balda exports a ",(0,i.jsx)(n.code,{children:"GraphQLContext"})," interface that you can extend to provide type-safe context in your resolvers."]}),"\n",(0,i.jsx)(n.h3,{id:"extending-the-context",children:"Extending the Context"}),"\n",(0,i.jsx)(n.p,{children:"Use TypeScript's module augmentation to extend the context type:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'import type { GraphQLContext } from "balda";\n\n// Define your custom context properties\ninterface User {\n  id: string;\n  name: string;\n  email: string;\n}\n\ninterface Database {\n  users: Map<string, User>;\n}\n\n// Extend the GraphQLContext interface\ndeclare module "balda" {\n  interface GraphQLContext {\n    user?: User;\n    db: Database;\n    req: Request;\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"using-typed-context-in-resolvers",children:"Using Typed Context in Resolvers"}),"\n",(0,i.jsx)(n.p,{children:"Once extended, your resolvers will have full type safety:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'server.graphql.addResolver("Query", {\n  me: (parent, args, context) => {\n    // context.user is now fully typed!\n    if (!context.user) {\n      throw new Error("Not authenticated");\n    }\n    return context.user;\n  },\n  users: (parent, args, context) => {\n    // context.db is typed as Database\n    return Array.from(context.db.users.values());\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"providing-context",children:"Providing Context"}),"\n",(0,i.jsx)(n.p,{children:"Context values are automatically provided by Apollo Server. The default context includes the Balda request object. You can extend the context using Apollo Server's context function:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const db: Database = {\n  users: new Map(),\n};\n\nconst server = new Server({\n  graphql: {\n    schema: {\n      typeDefs: `...`,\n      resolvers: {},\n    },\n    apolloOptions: {\n      context: async ({ req }) => {\n        // Extract user from request headers\n        const token =\n          req.headers?.get?.("authorization") ?? req.headers?.authorization;\n        const user = token ? await verifyToken(token) : undefined;\n\n        return {\n          user,\n          db,\n          req,\n        };\n      },\n    },\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"resolver-function-signature",children:"Resolver Function Signature"}),"\n",(0,i.jsx)(n.p,{children:"All resolver functions follow the standard GraphQL signature:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"type GraphQLResolverFunction<TContext = GraphQLContext> = (\n  parent: unknown,\n  args: Record<string, unknown>,\n  context: TContext,\n  info: GraphQLResolveInfo,\n) => unknown | Promise<unknown>;\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"parent"}),": The result of the parent resolver (for nested fields)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"args"}),": The arguments provided to the field"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"context"}),": The shared context object (typed via module augmentation)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"info"}),": GraphQL execution info (field name, parent type, schema details, etc.)"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Resolvers can return values synchronously or return a Promise for async operations."}),"\n",(0,i.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(n.p,{children:"Apollo Server automatically catches errors thrown in resolvers:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'server.graphql.addResolver("Query", {\n  user: async (parent, args, context) => {\n    const user = await context.db.users.get(args.id);\n\n    if (!user) {\n      throw new Error("User not found");\n    }\n\n    return user;\n  },\n});\n'})}),"\n",(0,i.jsx)(n.p,{children:"For custom error handling, use Apollo Server's error formatting options:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'import { GraphQLError } from "graphql";\n\nconst server = new Server({\n  graphql: {\n    apolloOptions: {\n      formatError: (formattedError, error) => {\n        // Don\'t expose internal errors in production\n        if (formattedError.message.includes("INTERNAL")) {\n          return new GraphQLError("Internal server error", {\n            extensions: {\n              code: "INTERNAL_SERVER_ERROR",\n            },\n          });\n        }\n        return formattedError;\n      },\n    },\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"apollo-sandbox",children:"Apollo Sandbox"}),"\n",(0,i.jsx)(n.p,{children:"Apollo Server includes a built-in Apollo Sandbox for GraphQL exploration and testing. Access it by navigating to your GraphQL endpoint in a browser:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"http://localhost:3000/graphql\n"})}),"\n",(0,i.jsx)(n.h3,{id:"enabling-apollo-sandbox",children:"Enabling Apollo Sandbox"}),"\n",(0,i.jsx)(n.p,{children:"To enable the Apollo Sandbox UI with full introspection support, configure your server with the landing page plugin:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'import { ApolloServerPluginLandingPageLocalDefault } from "@apollo/server/plugin/landingPage/default";\nimport { Server } from "balda";\n\nconst server = new Server({\n  graphql: {\n    schema: {\n      typeDefs: `...`,\n      resolvers: {},\n    },\n    apolloOptions: {\n      introspection: true, // Required for schema introspection\n      csrfPrevention: false, // Disable for local development\n      plugins: [ApolloServerPluginLandingPageLocalDefault()],\n    },\n  },\n});\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Important configuration options:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"introspection: true"})})," - Enables schema introspection, allowing the Sandbox UI to load your GraphQL schema"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"csrfPrevention: false"})})," - Disables CSRF prevention for local development (recommended for development only)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"ApolloServerPluginLandingPageLocalDefault()"})})," - Provides the Apollo Sandbox UI"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"using-the-sandbox-ui",children:"Using the Sandbox UI"}),"\n",(0,i.jsxs)(n.p,{children:["Once your server is running, navigate to ",(0,i.jsx)(n.code,{children:"http://localhost:3000/graphql"})," in your browser. The Sandbox UI provides:"]}),"\n",(0,i.jsxs)(n.h4,{id:"1-interactive-query-editor",children:["1. ",(0,i.jsx)(n.strong,{children:"Interactive Query Editor"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Auto-completion for types, fields, and arguments"}),"\n",(0,i.jsx)(n.li,{children:"Syntax highlighting"}),"\n",(0,i.jsx)(n.li,{children:"Real-time validation"}),"\n",(0,i.jsx)(n.li,{children:"Multiple tabs for different operations"}),"\n"]}),"\n",(0,i.jsxs)(n.h4,{id:"2-schema-explorer",children:["2. ",(0,i.jsx)(n.strong,{children:"Schema Explorer"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Browse your entire GraphQL schema"}),"\n",(0,i.jsx)(n.li,{children:"View type definitions and relationships"}),"\n",(0,i.jsx)(n.li,{children:"Search for specific types and fields"}),"\n",(0,i.jsx)(n.li,{children:"Documentation for each field (from schema descriptions)"}),"\n"]}),"\n",(0,i.jsxs)(n.h4,{id:"3-query-variables",children:["3. ",(0,i.jsx)(n.strong,{children:"Query Variables"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Test queries with dynamic variables"}),"\n",(0,i.jsx)(n.li,{children:"JSON editor with syntax validation"}),"\n",(0,i.jsx)(n.li,{children:"Variable type checking"}),"\n"]}),"\n",(0,i.jsxs)(n.h4,{id:"4-request-headers",children:["4. ",(0,i.jsx)(n.strong,{children:"Request Headers"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Add custom HTTP headers (authentication, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"Test authorization and authentication flows"}),"\n"]}),"\n",(0,i.jsxs)(n.h4,{id:"5-operation-history",children:["5. ",(0,i.jsx)(n.strong,{children:"Operation History"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Access previously executed queries"}),"\n",(0,i.jsx)(n.li,{children:"Save frequently used operations"}),"\n"]}),"\n",(0,i.jsxs)(n.h4,{id:"6-response-viewer",children:["6. ",(0,i.jsx)(n.strong,{children:"Response Viewer"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Formatted JSON responses"}),"\n",(0,i.jsx)(n.li,{children:"Error details with stack traces (in development)"}),"\n",(0,i.jsx)(n.li,{children:"Response timing information"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-testing-with-sandbox-ui",children:"Example: Testing with Sandbox UI"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'import { ApolloServerPluginLandingPageLocalDefault } from "@apollo/server/plugin/landingPage/default";\nimport { Server } from "balda";\n\nconst server = new Server({\n  port: 3000,\n  graphql: {\n    schema: {\n      typeDefs: `\n        type User {\n          id: ID!\n          name: String!\n          email: String!\n        }\n\n        type Query {\n          user(id: ID!): User\n          users: [User!]!\n        }\n\n        type Mutation {\n          createUser(name: String!, email: String!): User!\n        }\n      `,\n      resolvers: {\n        Query: {\n          user: (parent, args) => ({\n            id: args.id,\n            name: "John Doe",\n            email: "john@example.com",\n          }),\n          users: () => [\n            { id: "1", name: "John Doe", email: "john@example.com" },\n            { id: "2", name: "Jane Smith", email: "jane@example.com" },\n          ],\n        },\n        Mutation: {\n          createUser: (parent, args) => ({\n            id: "3",\n            name: args.name,\n            email: args.email,\n          }),\n        },\n      },\n    },\n    apolloOptions: {\n      introspection: true,\n      csrfPrevention: false,\n      plugins: [ApolloServerPluginLandingPageLocalDefault()],\n    },\n  },\n});\n\nserver.listen(({ url }) => {\n  console.log(`Server running at ${url}`);\n  console.log(`Apollo Sandbox: ${url}/graphql`);\n});\n'})}),"\n",(0,i.jsxs)(n.p,{children:["After starting the server, open ",(0,i.jsx)(n.code,{children:"http://localhost:3000/graphql"})," and try these queries in the Sandbox:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Query with arguments:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:"query GetUser($userId: ID!) {\n  user(id: $userId) {\n    id\n    name\n    email\n  }\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Variables:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "userId": "1"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Mutation:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:"mutation CreateUser($name: String!, $email: String!) {\n  createUser(name: $name, email: $email) {\n    id\n    name\n    email\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"production-configuration",children:"Production Configuration"}),"\n",(0,i.jsx)(n.p,{children:"For production environments, disable introspection and use a different landing page:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const server = new Server({\n  graphql: {\n    apolloOptions: {\n      // Disable introspection in production\n      introspection: process.env.NODE_ENV !== "production",\n\n      // Enable CSRF prevention\n      csrfPrevention: true,\n\n      // Use production landing page\n      plugins:\n        process.env.NODE_ENV === "production"\n          ? [ApolloServerPluginLandingPageDisabled()]\n          : [ApolloServerPluginLandingPageLocalDefault()],\n    },\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"troubleshooting-sandbox-issues",children:"Troubleshooting Sandbox Issues"}),"\n",(0,i.jsx)(n.p,{children:'If you see "Schema Introspection Failure" in the Sandbox:'}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Ensure introspection is enabled:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"apolloOptions: {\n  introspection: true,\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Disable CSRF prevention for local development:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"apolloOptions: {\n  csrfPrevention: false,\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Check that the GraphQL endpoint is accessible:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Open the browser console"}),"\n",(0,i.jsx)(n.li,{children:"Look for network errors"}),"\n",(0,i.jsx)(n.li,{children:"Verify the server is running"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Test with a simple curl command:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl -X POST http://localhost:3000/graphql \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"query\":\"{ __typename }\"}'\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"alternative-disable-landing-page",children:"Alternative: Disable Landing Page"}),"\n",(0,i.jsx)(n.p,{children:"If you don't want the Sandbox UI, you can disable it:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'import { ApolloServerPluginLandingPageDisabled } from "@apollo/server/plugin/disabled";\n\nconst server = new Server({\n  graphql: {\n    apolloOptions: {\n      plugins: [ApolloServerPluginLandingPageDisabled()],\n    },\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"lazy-loading",children:"Lazy Loading"}),"\n",(0,i.jsx)(n.p,{children:"GraphQL dependencies are loaded lazily when the first GraphQL request is made. This means:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"If GraphQL is not configured, the dependencies are never loaded"}),"\n",(0,i.jsx)(n.li,{children:"Apollo Server is only started when needed, improving startup performance"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"If the GraphQL peer dependencies are not installed and GraphQL is enabled, you'll receive a clear error message:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"GraphQL is enabled but '@apollo/server' is not installed.\nInstall it with: npm install @apollo/server @graphql-tools/schema graphql\n"})}),"\n",(0,i.jsx)(n.h2,{id:"runtime-support",children:"Runtime Support"}),"\n",(0,i.jsx)(n.p,{children:"GraphQL support works across all Balda runtimes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u2705 Node.js"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Bun"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Deno"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The implementation uses dynamic imports to load Apollo Server only when needed, ensuring optimal performance across all platforms."}),"\n",(0,i.jsx)(n.h2,{id:"advanced-features",children:"Advanced Features"}),"\n",(0,i.jsx)(n.h3,{id:"plugins",children:"Plugins"}),"\n",(0,i.jsx)(n.p,{children:"Apollo Server supports a powerful plugin system. You can add plugins for logging, caching, metrics, and more:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const server = new Server({\n  graphql: {\n    apolloOptions: {\n      plugins: [\n        {\n          async requestDidStart() {\n            return {\n              async willSendResponse({ response }) {\n                console.log("Sending response:", response);\n              },\n            };\n          },\n        },\n      ],\n    },\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"subscriptions",children:"Subscriptions"}),"\n",(0,i.jsx)(n.p,{children:"For GraphQL subscriptions support, you can configure Apollo Server with the appropriate transport:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'import { WebSocketServer } from "ws";\nimport { useServer } from "graphql-ws/lib/use/ws";\n\nconst server = new Server({\n  graphql: {\n    schema: {\n      typeDefs: `\n        type Subscription {\n          messageAdded: Message\n        }\n      `,\n      resolvers: {\n        Subscription: {\n          messageAdded: {\n            subscribe: () => pubsub.asyncIterator(["MESSAGE_ADDED"]),\n          },\n        },\n      },\n    },\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Explore ",(0,i.jsx)(n.a,{href:"https://www.apollographql.com/docs/apollo-server/",children:"Apollo Server documentation"})]}),"\n",(0,i.jsxs)(n.li,{children:["Learn about ",(0,i.jsx)(n.a,{href:"https://graphql.org/learn/schema/",children:"GraphQL schema design"})]}),"\n",(0,i.jsxs)(n.li,{children:["Check out ",(0,i.jsx)(n.a,{href:"https://www.apollographql.com/docs/apollo-server/builtin-plugins",children:"Apollo Server plugins"})]}),"\n",(0,i.jsxs)(n.li,{children:["Read about ",(0,i.jsx)(n.a,{href:"https://graphql.org/learn/best-practices/",children:"GraphQL best practices"})]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var s=r(6540);const i={},l=s.createContext(i);function o(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);