"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2258],{4979:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"storage/overview","title":"Storage","description":"Balda provides a unified storage interface for managing files across different storage providers (S3, Azure Blob, Local).","source":"@site/docs/storage/overview.md","sourceDirName":"storage","slug":"/storage/overview","permalink":"/balda/docs/storage/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda/tree/main/docs/docs/storage/overview.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docs","previous":{"title":"MQTT Overview","permalink":"/balda/docs/mqtt/overview"},"next":{"title":"Mailer","permalink":"/balda/docs/mailer/overview"}}');var t=r(4848),i=r(8453);const o={sidebar_position:1},l="Storage",a={},d=[{value:"Quick Setup",id:"quick-setup",level:2},{value:"What It Does",id:"what-it-does",level:2},{value:"Generated Configuration",id:"generated-configuration",level:2},{value:"S3 Example",id:"s3-example",level:3},{value:"Azure Example",id:"azure-example",level:3},{value:"Local Example",id:"local-example",level:3},{value:"Usage",id:"usage",level:2},{value:"Basic Operations",id:"basic-operations",level:3},{value:"Return Types",id:"return-types",level:3},{value:"Provider Capabilities",id:"provider-capabilities",level:2},{value:"Interface",id:"interface",level:2},{value:"Environment Variables",id:"environment-variables",level:2},{value:"S3",id:"s3",level:3},{value:"Azure",id:"azure",level:3},{value:"Local",id:"local",level:3}];function c(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"storage",children:"Storage"})}),"\n",(0,t.jsx)(n.p,{children:"Balda provides a unified storage interface for managing files across different storage providers (S3, Azure Blob, Local)."}),"\n",(0,t.jsx)(n.h2,{id:"quick-setup",children:"Quick Setup"}),"\n",(0,t.jsxs)(n.p,{children:["Use the ",(0,t.jsx)(n.code,{children:"setup-storage"})," command to install dependencies and create configuration:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npx balda setup-storage -t s3\nnpx balda setup-storage -t azure\nnpx balda setup-storage -t local\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Flags:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"-t, --type <provider>"}),": Storage provider (",(0,t.jsx)(n.code,{children:"s3"}),", ",(0,t.jsx)(n.code,{children:"azure"}),", ",(0,t.jsx)(n.code,{children:"local"}),") - ",(0,t.jsx)(n.strong,{children:"required"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"-o, --output <path>"}),": Output directory (default: ",(0,t.jsx)(n.code,{children:"src/storage/"}),")"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example with custom output:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npx balda setup-storage -t s3 -o src/config/\n"})}),"\n",(0,t.jsx)(n.h2,{id:"what-it-does",children:"What It Does"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Checks dependencies"})," - Skips installation if already present"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Installs required packages:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"S3"}),": ",(0,t.jsx)(n.code,{children:"@aws-sdk/client-s3"}),", ",(0,t.jsx)(n.code,{children:"@aws-sdk/s3-request-presigner"}),", ",(0,t.jsx)(n.code,{children:"@aws-sdk/cloudfront-signer"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Azure"}),": ",(0,t.jsx)(n.code,{children:"@azure/storage-blob"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Local"}),": No dependencies"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Creates config file"})," - Generates ",(0,t.jsx)(n.code,{children:"{type}.config.ts"})," with templates"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"generated-configuration",children:"Generated Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"s3-example",children:"S3 Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { S3StorageProvider } from "balda";\n\nexport const s3Provider = new S3StorageProvider({\n  s3ClientConfig: {\n    bucketName: process.env.S3_BUCKET || "your-bucket-name",\n    region: process.env.AWS_REGION || "us-east-1",\n    credentials: {\n      accessKeyId: process.env.AWS_ACCESS_KEY_ID || "",\n      secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY || "",\n    },\n  },\n  // Optional CloudFront signed URLs\n  cloudfrontOptions: {\n    domainName: process.env.CLOUDFRONT_DOMAIN || "",\n    keyPairId: process.env.CLOUDFRONT_KEY_PAIR_ID || "",\n    privateKey: process.env.CLOUDFRONT_PRIVATE_KEY || "",\n  },\n});\n'})}),"\n",(0,t.jsx)(n.h3,{id:"azure-example",children:"Azure Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { AzureBlobStorageProvider } from "balda";\n\nexport const azureProvider = new AzureBlobStorageProvider({\n  containerName: process.env.AZURE_CONTAINER_NAME || "your-container-name",\n  connectionString: process.env.AZURE_STORAGE_CONNECTION_STRING || "",\n  storageAccountName: process.env.AZURE_STORAGE_ACCOUNT || "",\n  storageAccountKey: process.env.AZURE_STORAGE_KEY || "",\n});\n'})}),"\n",(0,t.jsx)(n.h3,{id:"local-example",children:"Local Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { LocalStorageProvider } from "balda";\n\nexport const localProvider = new LocalStorageProvider({\n  directory: process.env.LOCAL_STORAGE_DIR || "./storage",\n});\n'})}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["LocalStorageProvider does not support signed URLs (",(0,t.jsx)(n.code,{children:"getDownloadUrl"}),"/",(0,t.jsx)(n.code,{children:"getUploadUrl"}),"). Use S3 or Azure Blob storage for presigned URL functionality."]})}),"\n",(0,t.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,t.jsx)(n.h3,{id:"basic-operations",children:"Basic Operations"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { Storage } from "balda";\nimport { s3Provider } from "./storage/s3.config";\n\nconst storage = new Storage({ s3: s3Provider }, { defaultProvider: "s3" });\n\n// Upload file\nawait storage.putObject("uploads/file.pdf", fileBuffer);\n\n// Get download URL (expires in 3600 seconds by default)\n// Note: Not supported with LocalStorageProvider\nconst url = await storage.getDownloadUrl("uploads/file.pdf", 7200);\n\n// List files\nconst files = await storage.listObjects("uploads/");\n\n// Download file (raw bytes)\nconst fileData = await storage.getObject("uploads/file.pdf");\n\n// Delete file\nawait storage.deleteObject("uploads/file.pdf");\n'})}),"\n",(0,t.jsx)(n.h3,{id:"return-types",children:"Return Types"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"getObject"})," method supports different return types via a second parameter:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'// Raw bytes (default) - returns Uint8Array\nconst rawData = await storage.getObject("file.pdf", "raw");\nconst rawData2 = await storage.getObject("file.pdf"); // same as "raw"\n\n// Text string - returns string\nconst textContent = await storage.getObject("document.txt", "text");\nconsole.log(textContent); // "Hello, World!"\n\n// ReadableStream - for large files or streaming\nconst stream = await storage.getObject("video.mp4", "stream");\nconst reader = stream.getReader();\nwhile (true) {\n  const { done, value } = await reader.read();\n  if (done) break;\n  // Process chunk\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"When to use each:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:'"raw"'})})," (default): Small to medium files, need binary data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:'"text"'})}),": Text files, need string content directly"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:'"stream"'})}),": Large files, need to process data incrementally"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'\n### Multiple Providers\n\n```ts\nimport { Storage } from "balda";\nimport { s3Provider } from "./storage/s3.config";\nimport { localProvider } from "./storage/local.config";\n\nconst storage = new Storage(\n  {\n    s3: s3Provider,\n    local: localProvider,\n  },\n  { defaultProvider: "local" }\n);\n\n// Use default provider (local)\nawait storage.putObject("file.txt", buffer);\n\n// Switch to S3\nawait storage.use("s3").putObject("file.txt", buffer);\n'})}),"\n",(0,t.jsx)(n.h2,{id:"provider-capabilities",children:"Provider Capabilities"}),"\n",(0,t.jsx)(n.p,{children:"Different storage providers have varying levels of support for certain features:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Feature"}),(0,t.jsx)(n.th,{children:"Local"}),(0,t.jsx)(n.th,{children:"S3"}),(0,t.jsx)(n.th,{children:"Azure Blob"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"putObject"})}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"getObject"})}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"listObjects"})}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"deleteObject"})}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"getDownloadUrl"})}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"getUploadUrl"})}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]})]})]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["For production applications requiring presigned URLs for direct client uploads/downloads, use ",(0,t.jsx)(n.strong,{children:"S3"})," or ",(0,t.jsx)(n.strong,{children:"Azure Blob"})," storage. Local storage is best suited for development or applications where files are accessed only through your server."]})}),"\n",(0,t.jsx)(n.h2,{id:"interface",children:"Interface"}),"\n",(0,t.jsx)(n.p,{children:"All storage providers implement these methods:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'interface StorageInterface {\n  getDownloadUrl(key: string, expiresInSeconds?: number): Promise<string>;\n  getUploadUrl(key: string, expiresInSeconds?: number): Promise<string>;\n  listObjects(prefix?: string): Promise<string[]>;\n  getObject<T>(key: string, returnType?: "raw" | "text" | "stream"): Promise<T | undefined>;\n  putObject<T>(key: string, value: T, contentType?: string): Promise<void>;\n  deleteObject(key: string): Promise<void>;\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Return type mapping:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"raw"'})," \u2192 ",(0,t.jsx)(n.code,{children:"Uint8Array"})," (default)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"text"'})," \u2192 ",(0,t.jsx)(n.code,{children:"string"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"stream"'})," \u2192 ",(0,t.jsx)(n.code,{children:"ReadableStream"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,t.jsx)(n.h3,{id:"s3",children:"S3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"AWS_ACCESS_KEY_ID=your-access-key\nAWS_SECRET_ACCESS_KEY=your-secret-key\nAWS_REGION=us-east-1\nS3_BUCKET=your-bucket-name\n\n# Optional for CloudFront\nCLOUDFRONT_DOMAIN=d1234567890.cloudfront.net\nCLOUDFRONT_KEY_PAIR_ID=your-key-pair-id\nCLOUDFRONT_PRIVATE_KEY=your-private-key\n"})}),"\n",(0,t.jsx)(n.h3,{id:"azure",children:"Azure"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"AZURE_STORAGE_CONNECTION_STRING=your-connection-string\nAZURE_CONTAINER_NAME=your-container-name\nAZURE_STORAGE_ACCOUNT=your-account-name\nAZURE_STORAGE_KEY=your-account-key\n"})}),"\n",(0,t.jsx)(n.h3,{id:"local",children:"Local"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"LOCAL_STORAGE_DIR=./storage\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"Local storage does not require environment variables for signed URLs since this functionality is not supported. For presigned URLs, use S3 or Azure Blob storage providers."})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>l});var s=r(6540);const t={},i=s.createContext(t);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);