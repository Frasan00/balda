"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5475],{3275:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>m,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"mailer/overview","title":"Mailer","description":"Balda provides a flexible mailer system with support for multiple email providers and template engines.","source":"@site/docs/mailer/overview.md","sourceDirName":"mailer","slug":"/mailer/overview","permalink":"/balda/docs/mailer/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda/tree/main/docs/docs/mailer/overview.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docs","previous":{"title":"Storage","permalink":"/balda/docs/storage/overview"},"next":{"title":"Express Compatibility","permalink":"/balda/docs/express/overview"}}');var i=a(4848),l=a(8453);const s={sidebar_position:1},r="Mailer",o={},d=[{value:"Quick Setup with CLI",id:"quick-setup-with-cli",level:2},{value:"Manual Installation",id:"manual-installation",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Using Mail Options Builder",id:"using-mail-options-builder",level:2},{value:"Template Adapters",id:"template-adapters",level:2},{value:"Handlebars",id:"handlebars",level:3},{value:"Edge.js",id:"edgejs",level:3},{value:"Mustache",id:"mustache",level:3},{value:"EJS",id:"ejs",level:3},{value:"Custom Adapter",id:"custom-adapter",level:3},{value:"Multiple Providers",id:"multiple-providers",level:2},{value:"Attachments",id:"attachments",level:2},{value:"Verify Connection",id:"verify-connection",level:2},{value:"Interface",id:"interface",level:2},{value:"Testing with MailCatcher",id:"testing-with-mailcatcher",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"mailer",children:"Mailer"})}),"\n",(0,i.jsx)(n.p,{children:"Balda provides a flexible mailer system with support for multiple email providers and template engines."}),"\n",(0,i.jsx)(n.h2,{id:"quick-setup-with-cli",children:"Quick Setup with CLI"}),"\n",(0,i.jsx)(n.p,{children:"The fastest way to get started is using the init-mailer command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Initialize with Handlebars template engine\nnpx balda init-mailer -t handlebars\n\n# Initialize without a template engine\nnpx balda init-mailer -t none\n\n# Initialize with custom output directory\nnpx balda init-mailer -t ejs -o src/email\n"})}),"\n",(0,i.jsx)(n.p,{children:"This command will:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Install all required dependencies"}),"\n",(0,i.jsx)(n.li,{children:"Create a ready-to-use mailer configuration file"}),"\n",(0,i.jsx)(n.li,{children:"Set up your chosen template engine"}),"\n",(0,i.jsx)(n.li,{children:"Include environment variable templates"}),"\n",(0,i.jsx)(n.li,{children:"Provide usage examples"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["See the ",(0,i.jsx)(n.a,{href:"/docs/commands/built-ins/init-mailer",children:"init-mailer command documentation"})," for more details."]}),"\n",(0,i.jsx)(n.h2,{id:"manual-installation",children:"Manual Installation"}),"\n",(0,i.jsx)(n.p,{children:"If you prefer manual setup, install Nodemailer (required):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install nodemailer\nnpm install --save-dev @types/nodemailer\n"})}),"\n",(0,i.jsx)(n.p,{children:"Install template engines (optional, only what you need):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Handlebars\nnpm install handlebars\nnpm install --save-dev @types/handlebars\n\n# Edge.js\nnpm install edge.js\n\n# Mustache\nnpm install mustache\nnpm install --save-dev @types/mustache\n\n# EJS\nnpm install ejs\nnpm install --save-dev @types/ejs\n"})}),"\n",(0,i.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'import { Mailer, HandlebarsAdapter } from "balda";\nimport nodemailer from "nodemailer";\n\nconst mailer = new Mailer(\n  {\n    smtp: {\n      transporter: nodemailer.createTransport({\n        host: "smtp.example.com",\n        port: 587,\n        auth: {\n          user: process.env.SMTP_USER,\n          pass: process.env.SMTP_PASS,\n        },\n      }),\n      templateAdapter: new HandlebarsAdapter(),\n      from: "noreply@example.com",\n    },\n  },\n  { defaultProvider: "smtp" },\n);\n\n// Send email\nawait mailer.send({\n  to: "user@example.com",\n  subject: "Welcome!",\n  html: "<h1>Hello World</h1>",\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"using-mail-options-builder",children:"Using Mail Options Builder"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'import { mailOptions } from "balda";\n\nawait mailer.send(\n  mailOptions()\n    .to("user@example.com")\n    .subject("Welcome!")\n    .html("<h1>Hello</h1>")\n    .attachment({\n      filename: "invoice.pdf",\n      content: pdfBuffer,\n    })\n    .build(),\n);\n'})}),"\n",(0,i.jsx)(n.h2,{id:"template-adapters",children:"Template Adapters"}),"\n",(0,i.jsx)(n.h3,{id:"handlebars",children:"Handlebars"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'import { HandlebarsAdapter } from "balda";\n\nconst adapter = new HandlebarsAdapter();\n\nawait mailer.sendWithTemplate({\n  to: "user@example.com",\n  subject: "Order Confirmation",\n  template: "<h1>Order #{{orderId}}</h1><p>Total: ${{total}}</p>",\n  data: { orderId: "12345", total: 99.99 },\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"edgejs",children:"Edge.js"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'import { EdgeAdapter } from "balda";\n\nconst adapter = new EdgeAdapter();\n\nawait mailer.sendWithTemplate({\n  to: "user@example.com",\n  subject: "Welcome",\n  template: "<h1>Hello {{ name }}</h1>",\n  data: { name: "John" },\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"mustache",children:"Mustache"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'import { MustacheAdapter } from "balda";\n\nconst adapter = new MustacheAdapter();\n\nawait mailer.sendWithTemplate({\n  to: "user@example.com",\n  subject: "Newsletter",\n  template: "<ul>{{#items}}<li>{{.}}</li>{{/items}}</ul>",\n  data: { items: ["Item 1", "Item 2"] },\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"ejs",children:"EJS"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'import { EjsAdapter } from "balda";\n\nconst adapter = new EjsAdapter();\n\nawait mailer.sendWithTemplate({\n  to: "user@example.com",\n  subject: "Report",\n  template: "<h1><%= title %></h1>",\n  data: { title: "Monthly Report" },\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"custom-adapter",children:"Custom Adapter"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'import { CustomAdapter } from "balda";\n\nconst adapter = new CustomAdapter();\nadapter.registerHelper("uppercase", (value) => String(value).toUpperCase());\n\nawait mailer.sendWithTemplate({\n  to: "user@example.com",\n  subject: "Custom",\n  template: "<h1>{{name:uppercase}}</h1>",\n  data: { name: "john" },\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"multiple-providers",children:"Multiple Providers"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const mailer = new Mailer(\n  {\n    smtp: {\n      transporter: nodemailer.createTransport({\n        host: "smtp.example.com",\n        port: 587,\n        auth: { user: "user", pass: "pass" },\n      }),\n      from: "noreply@example.com",\n    },\n    sendgrid: {\n      transporter: nodemailer.createTransport({\n        host: "smtp.sendgrid.net",\n        port: 587,\n        auth: { user: "apikey", pass: process.env.SENDGRID_API_KEY },\n      }),\n      from: "marketing@example.com",\n    },\n  },\n  { defaultProvider: "smtp" },\n);\n\n// Use default provider\nawait mailer.send({ to: "user@example.com", subject: "Test", text: "Hello" });\n\n// Switch provider\nawait mailer.use("sendgrid").send({\n  to: "user@example.com",\n  subject: "Newsletter",\n  html: "<h1>News</h1>",\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"attachments",children:"Attachments"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'await mailer.send(\n  mailOptions()\n    .to("user@example.com")\n    .subject("Invoice")\n    .html("<p>See attached invoice</p>")\n    .attachment({\n      filename: "invoice.pdf",\n      content: pdfBuffer,\n      contentType: "application/pdf",\n    })\n    .attachment({\n      filename: "logo.png",\n      path: "/path/to/logo.png",\n    })\n    .build(),\n);\n'})}),"\n",(0,i.jsx)(n.h2,{id:"verify-connection",children:"Verify Connection"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const isConnected = await mailer.verify();\nif (!isConnected) {\n  console.error("Failed to connect to mail server");\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"interface",children:"Interface"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'interface MailerInterface {\n  use(provider: string): MailProviderInterface;\n  send(options: MailOptions): Promise<void>;\n  sendWithTemplate(options: TemplateMailOptions): Promise<void>;\n  verify(): Promise<boolean>;\n}\n\ntype MailOptions = {\n  from?: string;\n  to: string | string[];\n  cc?: string | string[];\n  bcc?: string | string[];\n  subject: string;\n  text?: string;\n  html?: string;\n  attachments?: Attachment[];\n};\n\ntype TemplateMailOptions = Omit<MailOptions, "html" | "text"> & {\n  template: string;\n  data: Record<string, unknown>;\n};\n'})}),"\n",(0,i.jsx)(n.h2,{id:"testing-with-mailcatcher",children:"Testing with MailCatcher"}),"\n",(0,i.jsx)(n.p,{children:"For local development, use MailCatcher:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# docker-compose.yml\nmailcatcher:\n  image: schickling/mailcatcher\n  ports:\n    - "1025:1025" # SMTP\n    - "1080:1080" # Web UI\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const mailer = new Mailer(\n  {\n    mailcatcher: {\n      transporter: nodemailer.createTransport({\n        host: "localhost",\n        port: 1025,\n        ignoreTLS: true,\n      }),\n      from: "test@example.com",\n    },\n  },\n  { defaultProvider: "mailcatcher" },\n);\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Visit ",(0,i.jsx)(n.code,{children:"http://localhost:1080"})," to view sent emails."]})]})}function m(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>s,x:()=>r});var t=a(6540);const i={},l=t.createContext(i);function s(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);