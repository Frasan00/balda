"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1031],{247:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"plugins/cors","title":"CORS Plugin","description":"The CORS (Cross-Origin Resource Sharing) plugin enables cross-origin requests in your Balda.js application. It handles preflight requests and sets appropriate CORS headers for both simple and complex requests.","source":"@site/docs/plugins/cors.md","sourceDirName":"plugins","slug":"/plugins/cors","permalink":"/balda-js/docs/plugins/cors","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda-js/tree/main/docs/docs/plugins/cors.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2}}');var r=s(4848),o=s(8453);const t={sidebar_position:2},l="CORS Plugin",a={},c=[{value:"Features",id:"features",level:2},{value:"Basic Configuration",id:"basic-configuration",level:2},{value:"Simple Setup",id:"simple-setup",level:3},{value:"Development Configuration",id:"development-configuration",level:3},{value:"Configuration Options",id:"configuration-options",level:2},{value:"Origin Configuration",id:"origin-configuration",level:3},{value:"Methods Configuration",id:"methods-configuration",level:3},{value:"Headers Configuration",id:"headers-configuration",level:3},{value:"Advanced Configuration",id:"advanced-configuration",level:3},{value:"Environment-Based Configuration",id:"environment-based-configuration",level:2},{value:"Route-Level CORS",id:"route-level-cors",level:2},{value:"CORS Headers Explained",id:"cors-headers-explained",level:2},{value:"Request Headers",id:"request-headers",level:3},{value:"Response Headers",id:"response-headers",level:3},{value:"Preflight Requests",id:"preflight-requests",level:2},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Production Configuration",id:"production-configuration",level:3},{value:"Development vs Production",id:"development-vs-production",level:3},{value:"Common Issues and Solutions",id:"common-issues-and-solutions",level:2},{value:"Credentials with Wildcard Origin",id:"credentials-with-wildcard-origin",level:3},{value:"Multiple Origins with Credentials",id:"multiple-origins-with-credentials",level:3},{value:"Custom Headers",id:"custom-headers",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"cors-plugin",children:"CORS Plugin"})}),"\n",(0,r.jsx)(n.p,{children:"The CORS (Cross-Origin Resource Sharing) plugin enables cross-origin requests in your Balda.js application. It handles preflight requests and sets appropriate CORS headers for both simple and complex requests."}),"\n",(0,r.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Automatic Preflight Handling"}),": Automatically handles OPTIONS requests"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Flexible Origin Configuration"}),": Support for strings, arrays, and regex patterns"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Customizable Headers"}),": Configurable allowed and exposed headers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Credentials Support"}),": Enable/disable credentials for cross-origin requests"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Method Control"}),": Specify allowed HTTP methods"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"basic-configuration",children:"Basic Configuration"}),"\n",(0,r.jsx)(n.h3,{id:"simple-setup",children:"Simple Setup"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { Server } from 'balda-js';\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    cors: {\n      origin: '*'\n    }\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"development-configuration",children:"Development Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  port: 3000,\n  plugins: {\n    cors: {\n      origin: ['http://localhost:3000', 'http://localhost:3001'],\n      credentials: true,\n      methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],\n      allowedHeaders: ['Content-Type', 'Authorization']\n    }\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,r.jsx)(n.h3,{id:"origin-configuration",children:"Origin Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Allow all origins (not recommended for production)\ncors: {\n  origin: '*'\n}\n\n// Allow specific origins\ncors: {\n  origin: ['https://myapp.com', 'https://admin.myapp.com']\n}\n\n// Allow origins with regex patterns\ncors: {\n  origin: [\n    'https://myapp.com',\n    /^https:\\/\\/.*\\.myapp\\.com$/\n  ]\n}\n\n// Function-based origin validation\ncors: {\n  origin: (origin) => {\n    const allowedOrigins = ['https://myapp.com', 'https://admin.myapp.com'];\n    return allowedOrigins.includes(origin);\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"methods-configuration",children:"Methods Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Default methods (GET, HEAD, PUT, PATCH, POST, DELETE)\ncors: {\n  methods: ['GET', 'HEAD', 'PUT', 'PATCH', 'POST', 'DELETE']\n}\n\n// Custom methods\ncors: {\n  methods: ['GET', 'POST', 'PUT', 'DELETE']\n}\n\n// String format\ncors: {\n  methods: 'GET,POST,PUT,DELETE'\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"headers-configuration",children:"Headers Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Allow specific headers\ncors: {\n  allowedHeaders: ['Content-Type', 'Authorization', 'X-API-Key']\n}\n\n// Allow all headers\ncors: {\n  allowedHeaders: '*'\n}\n\n// Expose headers to the client\ncors: {\n  exposedHeaders: ['X-Total-Count', 'X-Page-Count']\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"advanced-configuration",children:"Advanced Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  port: 3000,\n  plugins: {\n    cors: {\n      origin: ['https://myapp.com', 'https://admin.myapp.com'],\n      methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],\n      allowedHeaders: ['Content-Type', 'Authorization', 'X-API-Key'],\n      exposedHeaders: ['X-Total-Count', 'X-Page-Count'],\n      credentials: true,\n      maxAge: 86400, // 24 hours\n      preflightContinue: false,\n      optionsSuccessStatus: 204\n    }\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"environment-based-configuration",children:"Environment-Based Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const isProduction = process.env.NODE_ENV === 'production';\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    cors: {\n      origin: isProduction\n        ? ['https://myapp.com']\n        : ['http://localhost:3000', 'http://localhost:3001'],\n      credentials: isProduction,\n      maxAge: isProduction ? 86400 : undefined\n    }\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"route-level-cors",children:"Route-Level CORS"}),"\n",(0,r.jsx)(n.p,{children:"You can also apply CORS middleware to specific routes:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { cors } from 'balda-js';\n\n@controller('/api')\nexport class ApiController {\n  @get('/public', {\n    middleware: [cors({ origin: '*' })]\n  })\n  async publicEndpoint(req: Request, res: Response) {\n    res.json({ message: 'Public endpoint' });\n  }\n\n  @get('/private', {\n    middleware: [cors({\n      origin: ['https://myapp.com'],\n      credentials: true\n    })]\n  })\n  async privateEndpoint(req: Request, res: Response) {\n    res.json({ message: 'Private endpoint' });\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"cors-headers-explained",children:"CORS Headers Explained"}),"\n",(0,r.jsx)(n.h3,{id:"request-headers",children:"Request Headers"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Origin"}),": The origin of the request (set by browser)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access-Control-Request-Method"}),": The HTTP method for the actual request"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access-Control-Request-Headers"}),": The headers for the actual request"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"response-headers",children:"Response Headers"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access-Control-Allow-Origin"}),": Which origins are allowed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access-Control-Allow-Methods"}),": Which HTTP methods are allowed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access-Control-Allow-Headers"}),": Which headers are allowed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access-Control-Expose-Headers"}),": Which headers are exposed to the client"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access-Control-Allow-Credentials"}),": Whether credentials are allowed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access-Control-Max-Age"}),": How long preflight results can be cached"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"preflight-requests",children:"Preflight Requests"}),"\n",(0,r.jsx)(n.p,{children:"CORS automatically handles preflight OPTIONS requests:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// This OPTIONS request is handled automatically\n// OPTIONS /api/users\n// Origin: https://myapp.com\n// Access-Control-Request-Method: POST\n// Access-Control-Request-Headers: Content-Type, Authorization\n\n// Response:\n// Access-Control-Allow-Origin: https://myapp.com\n// Access-Control-Allow-Methods: GET, POST, PUT, DELETE, PATCH\n// Access-Control-Allow-Headers: Content-Type, Authorization\n// Access-Control-Max-Age: 86400\n"})}),"\n",(0,r.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,r.jsx)(n.h3,{id:"production-configuration",children:"Production Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Secure production configuration\ncors: {\n  origin: ['https://myapp.com'], // Specific origins only\n  credentials: true,\n  methods: ['GET', 'POST', 'PUT', 'DELETE'],\n  allowedHeaders: ['Content-Type', 'Authorization'],\n  maxAge: 86400\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"development-vs-production",children:"Development vs Production"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const corsConfig = process.env.NODE_ENV === 'production'\n  ? {\n      origin: ['https://myapp.com'],\n      credentials: true,\n      maxAge: 86400\n    }\n  : {\n      origin: ['http://localhost:3000'],\n      credentials: false\n    };\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    cors: corsConfig\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"common-issues-and-solutions",children:"Common Issues and Solutions"}),"\n",(0,r.jsx)(n.h3,{id:"credentials-with-wildcard-origin",children:"Credentials with Wildcard Origin"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// \u274c This won't work - credentials require specific origins\ncors: {\n  origin: '*',\n  credentials: true\n}\n\n// \u2705 This works - specific origins with credentials\ncors: {\n  origin: ['https://myapp.com'],\n  credentials: true\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"multiple-origins-with-credentials",children:"Multiple Origins with Credentials"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Multiple specific origins with credentials\ncors: {\n  origin: ['https://myapp.com', 'https://admin.myapp.com'],\n  credentials: true\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"custom-headers",children:"Custom Headers"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Include custom headers\ncors: {\n  allowedHeaders: ['Content-Type', 'Authorization', 'X-Custom-Header'],\n  exposedHeaders: ['X-Total-Count', 'X-Page-Count']\n}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(6540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);