"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5475],{3275:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"mailer/overview","title":"Mailer","description":"Balda provides a flexible mailer system with support for multiple email providers and template engines.","source":"@site/docs/mailer/overview.md","sourceDirName":"mailer","slug":"/mailer/overview","permalink":"/balda/docs/mailer/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda/tree/main/docs/docs/mailer/overview.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docs","previous":{"title":"Storage","permalink":"/balda/docs/storage/overview"},"next":{"title":"Express Compatibility","permalink":"/balda/docs/express/overview"}}');var l=a(4848),i=a(8453);const r={sidebar_position:1},s="Mailer",d={},o=[{value:"Quick Setup with CLI",id:"quick-setup-with-cli",level:2},{value:"Manual Installation",id:"manual-installation",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Sending Emails",id:"sending-emails",level:2},{value:"Send Immediately",id:"send-immediately",level:3},{value:"Queue for Later",id:"queue-for-later",level:3},{value:"Templates",id:"templates",level:2},{value:"Inline Template",id:"inline-template",level:3},{value:"Template File",id:"template-file",level:3},{value:"Supported Template Engines",id:"supported-template-engines",level:3},{value:"Multiple Providers",id:"multiple-providers",level:2},{value:"Attachments",id:"attachments",level:2},{value:"API Reference",id:"api-reference",level:2},{value:"Builder Methods",id:"builder-methods",level:3},{value:"Mailer Methods",id:"mailer-methods",level:3},{value:"Testing with MailCatcher",id:"testing-with-mailcatcher",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"mailer",children:"Mailer"})}),"\n",(0,l.jsx)(n.p,{children:"Balda provides a flexible mailer system with support for multiple email providers and template engines."}),"\n",(0,l.jsx)(n.h2,{id:"quick-setup-with-cli",children:"Quick Setup with CLI"}),"\n",(0,l.jsx)(n.p,{children:"The fastest way to get started is using the init-mailer command:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Initialize with Handlebars template engine\nnpx balda init-mailer -t handlebars\n\n# Initialize without a template engine\nnpx balda init-mailer -t none\n\n# Initialize with custom output directory\nnpx balda init-mailer -t ejs -o src/email\n"})}),"\n",(0,l.jsx)(n.p,{children:"This command will:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Install all required dependencies"}),"\n",(0,l.jsx)(n.li,{children:"Create a ready-to-use mailer configuration file"}),"\n",(0,l.jsx)(n.li,{children:"Set up your chosen template engine"}),"\n",(0,l.jsx)(n.li,{children:"Include environment variable templates"}),"\n",(0,l.jsx)(n.li,{children:"Provide usage examples"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["See the ",(0,l.jsx)(n.a,{href:"/docs/commands/built-ins/init-mailer",children:"init-mailer command documentation"})," for more details."]}),"\n",(0,l.jsx)(n.h2,{id:"manual-installation",children:"Manual Installation"}),"\n",(0,l.jsx)(n.p,{children:"If you prefer manual setup, install Nodemailer (required):"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm install nodemailer\nnpm install --save-dev @types/nodemailer\n"})}),"\n",(0,l.jsx)(n.p,{children:"Install template engines (optional, only what you need):"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Handlebars\nnpm install handlebars\nnpm install --save-dev @types/handlebars\n\n# Edge.js\nnpm install edge.js\n\n# Mustache\nnpm install mustache\nnpm install --save-dev @types/mustache\n\n# EJS\nnpm install ejs\nnpm install --save-dev @types/ejs\n"})}),"\n",(0,l.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'import { Mailer, HandlebarsAdapter } from "balda";\nimport nodemailer from "nodemailer";\n\nconst mailer = new Mailer(\n  {\n    smtp: {\n      transporter: nodemailer.createTransport({\n        host: "smtp.example.com",\n        port: 587,\n        auth: {\n          user: process.env.SMTP_USER,\n          pass: process.env.SMTP_PASS,\n        },\n      }),\n      templateAdapter: new HandlebarsAdapter(),\n      from: "noreply@example.com",\n    },\n  },\n  { defaultProvider: "smtp" },\n);\n\n// Send email using builder callback\nawait mailer.send((builder) =>\n  builder\n    .to("user@example.com")\n    .subject("Welcome!")\n    .html("<h1>Hello World</h1>"),\n);\n'})}),"\n",(0,l.jsx)(n.h2,{id:"sending-emails",children:"Sending Emails"}),"\n",(0,l.jsx)(n.h3,{id:"send-immediately",children:"Send Immediately"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'await mailer.send((builder) =>\n  builder\n    .to("user@example.com")\n    .subject("Welcome!")\n    .html("<h1>Hello</h1>")\n    .attachment({ filename: "invoice.pdf", content: pdfBuffer }),\n);\n'})}),"\n",(0,l.jsx)(n.h3,{id:"queue-for-later",children:"Queue for Later"}),"\n",(0,l.jsx)(n.p,{children:"Queue emails for background processing with 1-second delays between sends. Useful for bulk sending, rate limiting, and reducing server load."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'await mailer.later((builder) =>\n  builder.to("user@example.com").subject("Newsletter").html("<h1>Update</h1>"),\n);\n'})}),"\n",(0,l.jsx)(n.h2,{id:"templates",children:"Templates"}),"\n",(0,l.jsx)(n.h3,{id:"inline-template",children:"Inline Template"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'await mailer.send((builder) =>\n  builder\n    .to("user@example.com")\n    .subject("Order #{{orderId}}")\n    .template("<h1>Order #{{orderId}}</h1><p>Total: ${{total}}</p>", {\n      orderId: "12345",\n      total: 99.99,\n    }),\n);\n'})}),"\n",(0,l.jsx)(n.h3,{id:"template-file",children:"Template File"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'await mailer.send((builder) =>\n  builder\n    .to("user@example.com")\n    .subject("Welcome")\n    .templateFile("./templates/welcome.hbs", {\n      name: "John",\n      verificationUrl: "https://example.com/verify",\n    }),\n);\n'})}),"\n",(0,l.jsx)(n.h3,{id:"supported-template-engines",children:"Supported Template Engines"}),"\n",(0,l.jsx)(n.p,{children:"Configure with your preferred adapter:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'import {\n  HandlebarsAdapter,\n  EdgeAdapter,\n  MustacheAdapter,\n  EjsAdapter,\n  CustomAdapter,\n} from "balda";\n\n// In mailer config\ntemplateAdapter: new HandlebarsAdapter(), // or EdgeAdapter, etc.\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Custom Adapter"})," allows registering custom helpers:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'const adapter = new CustomAdapter();\nadapter.registerHelper("uppercase", (value) => String(value).toUpperCase());\n'})}),"\n",(0,l.jsx)(n.h2,{id:"multiple-providers",children:"Multiple Providers"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'const mailer = new Mailer(\n  {\n    smtp: {\n      transporter: nodemailer.createTransport({\n        host: "smtp.example.com",\n        port: 587,\n        auth: { user: "user", pass: "pass" },\n      }),\n      from: "noreply@example.com",\n    },\n    sendgrid: {\n      transporter: nodemailer.createTransport({\n        host: "smtp.sendgrid.net",\n        port: 587,\n        auth: { user: "apikey", pass: process.env.SENDGRID_API_KEY },\n      }),\n      from: "marketing@example.com",\n    },\n  },\n  { defaultProvider: "smtp" },\n);\n\n// Use default provider\nawait mailer.send((builder) =>\n  builder.to("user@example.com").subject("Test").text("Hello"),\n);\n\n// Switch provider\nawait mailer\n  .use("sendgrid")\n  .send((builder) =>\n    builder.to("user@example.com").subject("Newsletter").html("<h1>News</h1>"),\n  );\n'})}),"\n",(0,l.jsx)(n.h2,{id:"attachments",children:"Attachments"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'await mailer.send((builder) =>\n  builder\n    .to("user@example.com")\n    .subject("Invoice")\n    .html("<p>See attached</p>")\n    .attachment({ filename: "invoice.pdf", content: pdfBuffer })\n    .attachments([\n      { filename: "file1.pdf", content: buffer1 },\n      { filename: "file2.pdf", path: "/path/to/file2.pdf" },\n    ]),\n);\n'})}),"\n",(0,l.jsx)(n.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,l.jsx)(n.h3,{id:"builder-methods",children:"Builder Methods"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"builder\n  .from(email: string)\n  .to(email: string | string[]) // required\n  .cc(email: string | string[])\n  .bcc(email: string | string[])\n  .subject(text: string) // required\n  .text(content: string)\n  .html(content: string)\n  .template(template: string, data: object)\n  .templateFile(path: string, data: object)\n  .attachment(attachment: Attachment)\n  .attachments(attachments: Attachment[]);\n"})}),"\n",(0,l.jsx)(n.h3,{id:"mailer-methods",children:"Mailer Methods"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"await mailer.send(builderFn); // Send immediately\nawait mailer.later(builderFn); // Queue for background processing\nawait mailer.verify(); // Verify connection\nmailer.use(provider); // Switch provider\n"})}),"\n",(0,l.jsx)(n.h2,{id:"testing-with-mailcatcher",children:"Testing with MailCatcher"}),"\n",(0,l.jsx)(n.p,{children:"For local development, use MailCatcher:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'# docker-compose.yml\nmailcatcher:\n  image: schickling/mailcatcher\n  ports:\n    - "1025:1025" # SMTP\n    - "1080:1080" # Web UI\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'const mailer = new Mailer(\n  {\n    mailcatcher: {\n      transporter: nodemailer.createTransport({\n        host: "localhost",\n        port: 1025,\n        ignoreTLS: true,\n      }),\n      from: "test@example.com",\n    },\n  },\n  { defaultProvider: "mailcatcher" },\n);\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Visit ",(0,l.jsx)(n.code,{children:"http://localhost:1080"})," to view sent emails."]})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>r,x:()=>s});var t=a(6540);const l={},i=t.createContext(l);function r(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);