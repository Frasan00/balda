"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8863],{8449:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"plugins/static","title":"Static Plugin","description":"The Static plugin serves static files from a specified directory. It automatically handles file serving, MIME type detection, and provides a clean API for serving static assets like images, CSS, JavaScript, and other files.","source":"@site/docs/plugins/static.md","sourceDirName":"plugins","slug":"/plugins/static","permalink":"/balda-js/docs/plugins/static","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda-js/tree/main/docs/docs/plugins/static.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4}}');var t=s(4848),r=s(8453);const l={sidebar_position:4},c="Static Plugin",a={},d=[{value:"Features",id:"features",level:2},{value:"Basic Configuration",id:"basic-configuration",level:2},{value:"Required Configuration",id:"required-configuration",level:3},{value:"Separate Source and URL Path",id:"separate-source-and-url-path",level:3},{value:"Configuration Options",id:"configuration-options",level:2},{value:"Examples",id:"examples",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Basic File Serving",id:"basic-file-serving",level:3},{value:"Serving from Nested Directory",id:"serving-from-nested-directory",level:3},{value:"Different Source and Path",id:"different-source-and-path",level:3},{value:"User Uploads Example",id:"user-uploads-example",level:3},{value:"File Types and MIME Types",id:"file-types-and-mime-types",level:2},{value:"Supported File Types",id:"supported-file-types",level:3},{value:"Custom MIME Types",id:"custom-mime-types",level:3},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Directory Traversal Protection",id:"directory-traversal-protection",level:3},{value:"File Access Control",id:"file-access-control",level:3},{value:"Real-World Examples",id:"real-world-examples",level:2},{value:"Serving Built Assets",id:"serving-built-assets",level:3},{value:"Temporary File Storage",id:"temporary-file-storage",level:3},{value:"Multi-tenant Storage",id:"multi-tenant-storage",level:3},{value:"Serving User Uploads",id:"serving-user-uploads",level:3},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Caching Headers",id:"caching-headers",level:3},{value:"Compression",id:"compression",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"File Not Found",id:"file-not-found",level:3},{value:"Method Not Allowed",id:"method-not-allowed",level:3},{value:"Integration with Other Plugins",id:"integration-with-other-plugins",level:2},{value:"With CORS",id:"with-cors",level:3},{value:"With Helmet",id:"with-helmet",level:3},{value:"Type Definition",id:"type-definition",level:2},{value:"TypeScript Example",id:"typescript-example",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"static-plugin",children:"Static Plugin"})}),"\n",(0,t.jsx)(n.p,{children:"The Static plugin serves static files from a specified directory. It automatically handles file serving, MIME type detection, and provides a clean API for serving static assets like images, CSS, JavaScript, and other files."}),"\n",(0,t.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Automatic MIME Type Detection"}),": Detects content types based on file extensions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Flexible Path Configuration"}),": Separate source directory and URL path"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Path-Based Routing"}),": Serves files from any API path"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Security"}),": Only serves files from the specified directory"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Performance"}),": Efficient file serving with proper headers"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Swagger Integration"}),": Optional Swagger documentation for static routes"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"basic-configuration",children:"Basic Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"required-configuration",children:"Required Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["The static plugin requires both ",(0,t.jsx)(n.code,{children:"source"})," (file system directory) and ",(0,t.jsx)(n.code,{children:"path"})," (URL path) to be explicitly specified:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { Server } from 'balda-js';\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    static: {\n      source: 'public',  // File system directory\n      path: '/public'    // URL path\n    }\n  }\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"separate-source-and-url-path",children:"Separate Source and URL Path"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  port: 3000,\n  plugins: {\n    static: {\n      source: 'tmp/assets', // File system directory\n      path: '/assets'       // URL path\n    }\n  }\n});\n\n// Files in ./tmp/assets/test.html will be available at:\n// http://localhost:3000/assets/test.html\n"})}),"\n",(0,t.jsx)(n.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,t.jsxs)(n.p,{children:["Both ",(0,t.jsx)(n.code,{children:"source"})," and ",(0,t.jsx)(n.code,{children:"path"})," properties are ",(0,t.jsx)(n.strong,{children:"required"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"static: {\n  source: string,  // Required: File system directory path\n  path: string     // Required: URL path where files are served\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Serve from 'public' directory at '/public' path\nstatic: {\n  source: 'public',\n  path: '/public'\n}\n\n// Serve from 'assets' directory at '/assets' path\nstatic: {\n  source: 'assets',\n  path: '/assets'\n}\n\n// Serve from nested directory at different URL path\nstatic: {\n  source: 'storage/app/public',\n  path: '/uploads'\n}\n\n// Serve from tmp directory at clean URL\nstatic: {\n  source: 'tmp/assets',\n  path: '/files'\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,t.jsx)(n.h3,{id:"basic-file-serving",children:"Basic File Serving"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Directory structure:\n// public/\n//   \u251c\u2500\u2500 index.html\n//   \u251c\u2500\u2500 css/\n//   \u2502   \u2514\u2500\u2500 style.css\n//   \u251c\u2500\u2500 js/\n//   \u2502   \u2514\u2500\u2500 app.js\n//   \u2514\u2500\u2500 images/\n//       \u2514\u2500\u2500 logo.png\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    static: {\n      source: 'public',\n      path: '/public'\n    }\n  }\n});\n\n// Files will be available at:\n// http://localhost:3000/public/index.html\n// http://localhost:3000/public/css/style.css\n// http://localhost:3000/public/js/app.js\n// http://localhost:3000/public/images/logo.png\n"})}),"\n",(0,t.jsx)(n.h3,{id:"serving-from-nested-directory",children:"Serving from Nested Directory"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Serve files from tmp/assets at /assets URL path\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    static: {\n      source: 'tmp/assets',\n      path: '/assets'\n    }\n  }\n});\n\n// File at ./tmp/assets/test.pdf will be available at:\n// http://localhost:3000/assets/test.pdf\n"})}),"\n",(0,t.jsx)(n.h3,{id:"different-source-and-path",children:"Different Source and Path"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Serve build output at root path\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    static: {\n      source: 'dist/client',  // Where files are built\n      path: '/app'             // Where they're served\n    }\n  }\n});\n\n// File at ./dist/client/bundle.js will be at:\n// http://localhost:3000/app/bundle.js\n"})}),"\n",(0,t.jsx)(n.h3,{id:"user-uploads-example",children:"User Uploads Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Typical use case: user uploads stored separately\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    static: {\n      source: 'storage/uploads',  // Private storage directory\n      path: '/uploads'             // Public URL path\n    }\n  }\n});\n\n// File at ./storage/uploads/avatar.png will be at:\n// http://localhost:3000/uploads/avatar.png\n"})}),"\n",(0,t.jsx)(n.h2,{id:"file-types-and-mime-types",children:"File Types and MIME Types"}),"\n",(0,t.jsx)(n.p,{children:"The static plugin automatically detects MIME types for common file extensions:"}),"\n",(0,t.jsx)(n.h3,{id:"supported-file-types",children:"Supported File Types"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Extension"}),(0,t.jsx)(n.th,{children:"MIME Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".html"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"text/html"})}),(0,t.jsx)(n.td,{children:"HTML files"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".css"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"text/css"})}),(0,t.jsx)(n.td,{children:"CSS stylesheets"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".js"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"application/javascript"})}),(0,t.jsx)(n.td,{children:"JavaScript files"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".png"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"image/png"})}),(0,t.jsx)(n.td,{children:"PNG images"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:".jpg"}),", ",(0,t.jsx)(n.code,{children:".jpeg"})]}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"image/jpeg"})}),(0,t.jsx)(n.td,{children:"JPEG images"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".gif"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"image/gif"})}),(0,t.jsx)(n.td,{children:"GIF images"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".svg"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"image/svg+xml"})}),(0,t.jsx)(n.td,{children:"SVG images"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".json"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"application/json"})}),(0,t.jsx)(n.td,{children:"JSON files"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".txt"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"text/plain"})}),(0,t.jsx)(n.td,{children:"Text files"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".ico"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"image/x-icon"})}),(0,t.jsx)(n.td,{children:"Favicon files"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".webp"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"image/webp"})}),(0,t.jsx)(n.td,{children:"WebP images"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".mp4"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"video/mp4"})}),(0,t.jsx)(n.td,{children:"MP4 videos"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".mp3"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"audio/mpeg"})}),(0,t.jsx)(n.td,{children:"MP3 audio"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".wav"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"audio/wav"})}),(0,t.jsx)(n.td,{children:"WAV audio"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".ogg"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"audio/ogg"})}),(0,t.jsx)(n.td,{children:"OGG audio"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:".webm"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"video/webm"})}),(0,t.jsx)(n.td,{children:"WebM videos"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"custom-mime-types",children:"Custom MIME Types"}),"\n",(0,t.jsxs)(n.p,{children:["For unsupported file types, the plugin defaults to ",(0,t.jsx)(n.code,{children:"application/octet-stream"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,t.jsx)(n.h3,{id:"directory-traversal-protection",children:"Directory Traversal Protection"}),"\n",(0,t.jsx)(n.p,{children:"The static plugin automatically protects against directory traversal attacks:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u274c This will NOT work (directory traversal attempt)\n// GET /public/../../../etc/passwd\n\n// \u2705 This will work (valid file path)\n// GET /public/css/style.css\n"})}),"\n",(0,t.jsx)(n.h3,{id:"file-access-control",children:"File Access Control"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Only files within the specified source directory are accessible\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    static: {\n      source: 'public',\n      path: '/files'\n    }\n  }\n});\n\n// Files outside the source directory are not accessible\n// GET /files/../secret.txt -> 404 Not Found\n"})}),"\n",(0,t.jsx)(n.h2,{id:"real-world-examples",children:"Real-World Examples"}),"\n",(0,t.jsx)(n.h3,{id:"serving-built-assets",children:"Serving Built Assets"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Frontend build output\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    static: {\n      source: 'dist/public',  // Build output directory\n      path: '/static'          // CDN-like path\n    }\n  }\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"temporary-file-storage",children:"Temporary File Storage"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Temporary uploads that need to be served\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    static: {\n      source: 'tmp/exports',  // Temporary file storage\n      path: '/downloads'       // Clean download URL\n    }\n  }\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"multi-tenant-storage",children:"Multi-tenant Storage"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Serve tenant-specific files\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    static: {\n      source: 'storage/tenant1/public',\n      path: '/media'\n    }\n  }\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"serving-user-uploads",children:"Serving User Uploads"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// User-uploaded content\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    static: {\n      source: 'storage/uploads',\n      path: '/uploads'\n    }\n  }\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,t.jsx)(n.h3,{id:"caching-headers",children:"Caching Headers"}),"\n",(0,t.jsx)(n.p,{children:"Consider adding caching middleware for static assets:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"@controller('/public')\nexport class StaticController {\n  @get('/*')\n  async serveStatic(req: Request, res: Response) {\n    // Add caching headers for static assets\n    res.setHeader('Cache-Control', 'public, max-age=31536000'); // 1 year\n    res.setHeader('ETag', generateETag(req.url));\n\n    // Serve the file\n    return staticFileHandler(req, res, 'public');\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"compression",children:"Compression"}),"\n",(0,t.jsx)(n.p,{children:"For better performance, consider enabling compression:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  port: 3000,\n  plugins: {\n    static: 'public',\n    // Add compression plugin for static assets\n    compression: {\n      filter: (req) => {\n        // Compress static assets\n        return req.url.startsWith('/public/');\n      }\n    }\n  }\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(n.h3,{id:"file-not-found",children:"File Not Found"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'// Request: GET /public/nonexistent.html\n// Response: 404 Not Found\n{\n  "error": "Route not found",\n  "message": "GET /public/nonexistent.html not found"\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"method-not-allowed",children:"Method Not Allowed"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'// Request: POST /public/index.html\n// Response: 405 Method Not Allowed\n{\n  "error": "Method not allowed",\n  "message": "POST not allowed for /public/index.html"\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"integration-with-other-plugins",children:"Integration with Other Plugins"}),"\n",(0,t.jsx)(n.h3,{id:"with-cors",children:"With CORS"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  port: 3000,\n  plugins: {\n    cors: {\n      origin: '*',\n      methods: ['GET', 'HEAD']\n    },\n    static: {\n      source: 'public',\n      path: '/public'\n    }\n  }\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"with-helmet",children:"With Helmet"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  port: 3000,\n  plugins: {\n    helmet: {\n      contentSecurityPolicy: {\n        directives: {\n          defaultSrc: [\"'self'\"],\n          styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n          scriptSrc: [\"'self'\"],\n          imgSrc: [\"'self'\", \"data:\", \"https:\"]\n        }\n      }\n    },\n    static: {\n      source: 'public',\n      path: '/public'\n    }\n  }\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"type-definition",children:"Type Definition"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"type StaticPluginOptions = {\n  source: string;  // Required: File system directory path\n  path: string;    // Required: URL path where files are served\n};\n"})}),"\n",(0,t.jsx)(n.h3,{id:"typescript-example",children:"TypeScript Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { Server, StaticPluginOptions } from 'balda-js';\n\nconst staticConfig: StaticPluginOptions = {\n  source: 'public',\n  path: '/public'\n};\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    static: staticConfig\n  }\n});\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>c});var i=s(6540);const t={},r=i.createContext(t);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);