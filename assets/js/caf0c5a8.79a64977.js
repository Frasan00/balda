"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1270],{4132:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>p,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"plugins/json","title":"JSON Plugin","description":"The JSON plugin parses incoming JSON request bodies and populates req.body with the parsed data. It automatically handles content-type detection and provides configurable size limits and error handling.","source":"@site/docs/plugins/json.md","sourceDirName":"plugins","slug":"/plugins/json","permalink":"/balda-js/docs/plugins/json","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda-js/tree/main/docs/docs/plugins/json.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3}}');var r=s(4848),o=s(8453);const t={sidebar_position:3},l="JSON Plugin",a={},d=[{value:"Features",id:"features",level:2},{value:"Basic Configuration",id:"basic-configuration",level:2},{value:"Simple Setup",id:"simple-setup",level:3},{value:"Default Configuration",id:"default-configuration",level:3},{value:"Configuration Options",id:"configuration-options",level:2},{value:"Size Limit",id:"size-limit",level:3},{value:"Empty Body Handling",id:"empty-body-handling",level:3},{value:"Custom Error Messages",id:"custom-error-messages",level:3},{value:"Encoding Configuration",id:"encoding-configuration",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Basic JSON Parsing",id:"basic-json-parsing",level:3},{value:"Handling Large Payloads",id:"handling-large-payloads",level:3},{value:"Empty Body Scenarios",id:"empty-body-scenarios",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Size Limit Exceeded",id:"size-limit-exceeded",level:3},{value:"Invalid JSON",id:"invalid-json",level:3},{value:"Invalid Encoding",id:"invalid-encoding",level:3},{value:"Content-Type Detection",id:"content-type-detection",level:2},{value:"Non-JSON Requests",id:"non-json-requests",level:3},{value:"HTTP Method Restrictions",id:"http-method-restrictions",level:2},{value:"Advanced Configuration",id:"advanced-configuration",level:2},{value:"Production vs Development",id:"production-vs-development",level:3},{value:"Multiple Content Types",id:"multiple-content-types",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Memory Usage",id:"memory-usage",level:3},{value:"Streaming for Large Files",id:"streaming-for-large-files",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"json-plugin",children:"JSON Plugin"})}),"\n",(0,r.jsxs)(n.p,{children:["The JSON plugin parses incoming JSON request bodies and populates ",(0,r.jsx)(n.code,{children:"req.body"})," with the parsed data. It automatically handles content-type detection and provides configurable size limits and error handling."]}),"\n",(0,r.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Automatic Content-Type Detection"}),": Parses requests with ",(0,r.jsx)(n.code,{children:"application/json"})," content type"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Configurable Size Limits"}),": Set maximum body size to prevent memory issues"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Encoding Support"}),": Support for various text encodings"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error Handling"}),": Graceful handling of malformed JSON"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Empty Body Handling"}),": Configurable behavior for empty request bodies"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"basic-configuration",children:"Basic Configuration"}),"\n",(0,r.jsx)(n.h3,{id:"simple-setup",children:"Simple Setup"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { Server } from 'balda-js';\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    json: {\n      sizeLimit: 10 * 1024 * 1024 // 10MB in bytes\n    }\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"default-configuration",children:"Default Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  port: 3000,\n  plugins: {\n    json: {\n      sizeLimit: 5 * 1024 * 1024, // 5MB (default)\n      parseEmptyBodyAsObject: false, // default\n      encoding: 'utf-8' // default\n    }\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,r.jsx)(n.h3,{id:"size-limit",children:"Size Limit"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"sizeLimit"})," option accepts a number representing the maximum size in bytes."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// 1MB limit\njson: {\n  sizeLimit: 1024 * 1024 // 1MB\n}\n\n// 10MB limit\njson: {\n  sizeLimit: 10 * 1024 * 1024 // 10MB\n}\n\n// Large payloads (50MB)\njson: {\n  sizeLimit: 50 * 1024 * 1024 // 50MB\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"empty-body-handling",children:"Empty Body Handling"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Default behavior - empty body becomes undefined\njson: {\n  parseEmptyBodyAsObject: false\n}\n\n// Empty body becomes empty object\njson: {\n  parseEmptyBodyAsObject: true\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"custom-error-messages",children:"Custom Error Messages"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"json: {\n  sizeLimit: 10 * 1024 * 1024, // 10MB\n  customErrorMessage: {\n    status: 413,\n    message: 'Request body too large'\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"encoding-configuration",children:"Encoding Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// UTF-8 (default)\njson: {\n  encoding: 'utf-8'\n}\n\n// UTF-16\njson: {\n  encoding: 'utf-16le'\n}\n\n// Other encodings\njson: {\n  encoding: 'iso-8859-1'\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,r.jsx)(n.h3,{id:"basic-json-parsing",children:"Basic JSON Parsing"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class ApiController {\n  @post('/users')\n  async createUser(req: Request, res: Response) {\n    // req.body is automatically parsed JSON\n    const { name, email, age } = req.body;\n\n    const user = await createUser({ name, email, age });\n    res.created(user);\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"handling-large-payloads",children:"Handling Large Payloads"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  port: 3000,\n  plugins: {\n    json: {\n      sizeLimit: 50 * 1024 * 1024, // 50MB - Allow large JSON payloads\n      customErrorMessage: {\n        status: 413,\n        message: 'Payload too large'\n      }\n    }\n  }\n});\n\n@controller('/api')\nexport class DataController {\n  @post('/data')\n  async uploadData(req: Request, res: Response) {\n    // Handle large JSON payloads\n    const data = req.body;\n    res.json({ message: 'Data received successfully' });\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"empty-body-scenarios",children:"Empty Body Scenarios"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class HealthController {\n  @post('/health')\n  async healthCheck(req: Request, res: Response) {\n    if (req.body === undefined) {\n      // Empty body with parseEmptyBodyAsObject: false\n      res.json({ status: 'ok', body: 'empty' });\n    } else if (Object.keys(req.body).length === 0) {\n      // Empty body with parseEmptyBodyAsObject: true\n      res.json({ status: 'ok', body: 'empty object' });\n    } else {\n      res.json({ status: 'ok', body: req.body });\n    }\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.h3,{id:"size-limit-exceeded",children:"Size Limit Exceeded"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Request with body larger than sizeLimit\n// Response: 413 Payload Too Large\n{\n  "error": "ERR_REQUEST_BODY_TOO_LARGE"\n}\n\n// With custom error message\n{\n  "error": "Request body too large"\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"invalid-json",children:"Invalid JSON"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Request with malformed JSON\n// POST /api/users\n// Content-Type: application/json\n// Body: { "name": "John", "email": "john@example.com" }\n\n// Response: 400 Bad Request\n{\n  "error": "Invalid JSON syntax"\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"invalid-encoding",children:"Invalid Encoding"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Request with unsupported encoding\n// Response: 400 Bad Request\n{\n  "error": "Invalid request body encoding"\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"content-type-detection",children:"Content-Type Detection"}),"\n",(0,r.jsx)(n.p,{children:"The JSON plugin automatically detects and parses requests with the following content types:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"application/json"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"application/json; charset=utf-8"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"application/json; charset=UTF-8"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"non-json-requests",children:"Non-JSON Requests"}),"\n",(0,r.jsxs)(n.p,{children:["Requests without ",(0,r.jsx)(n.code,{children:"application/json"})," content type are ignored:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// This request will NOT be parsed by the JSON plugin\n// POST /api/users\n// Content-Type: application/x-www-form-urlencoded\n// Body: name=John&email=john@example.com\n\n@post('/users')\nasync createUser(req: Request, res: Response) {\n  // req.body will be undefined or handled by another parser\n  console.log(req.body); // undefined\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"http-method-restrictions",children:"HTTP Method Restrictions"}),"\n",(0,r.jsx)(n.p,{children:"The JSON plugin only parses bodies for methods that can have a body:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parsed"}),": POST, PUT, PATCH"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ignored"}),": GET, DELETE, HEAD, OPTIONS"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class UsersController {\n  @get('/users')\n  async getUsers(req: Request, res: Response) {\n    // req.body will be undefined (GET request)\n    res.json({ users: [] });\n  }\n\n  @post('/users')\n  async createUser(req: Request, res: Response) {\n    // req.body will be parsed JSON\n    res.created(req.body);\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"advanced-configuration",children:"Advanced Configuration"}),"\n",(0,r.jsx)(n.h3,{id:"production-vs-development",children:"Production vs Development"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const isProduction = process.env.NODE_ENV === 'production';\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    json: {\n      sizeLimit: isProduction\n        ? 1 * 1024 * 1024      // 1MB in production\n        : 10 * 1024 * 1024,    // 10MB in development\n      parseEmptyBodyAsObject: false,\n      encoding: 'utf-8',\n      customErrorMessage: isProduction ? {\n        status: 413,\n        message: 'Request too large'\n      } : undefined\n    }\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"multiple-content-types",children:"Multiple Content Types"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// JSON plugin handles application/json\n// URL-encoded plugin handles application/x-www-form-urlencoded\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    json: {\n      sizeLimit: 10 * 1024 * 1024 // 10MB\n    },\n    urlencoded: {\n      extended: true\n    }\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,r.jsx)(n.h3,{id:"memory-usage",children:"Memory Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Be careful with large size limits\njson: {\n  sizeLimit: 100 * 1024 * 1024 // 100MB - Could cause memory issues\n}\n\n// Recommended for most applications\njson: {\n  sizeLimit: 10 * 1024 * 1024 // 10MB - Reasonable limit\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"streaming-for-large-files",children:"Streaming for Large Files"}),"\n",(0,r.jsx)(n.p,{children:"For very large files, consider using the file upload plugin instead:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// For large files, use file upload plugin\nplugins: {\n  file: {\n    maxFileSize: 50 * 1024 * 1024 // 50MB\n  }\n}\n"})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(6540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);