"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[459],{8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>i});var r=s(6540);const o={},t=r.createContext(o);function l(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),r.createElement(t.Provider,{value:n},e.children)}},9823:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>g,frontMatter:()=>l,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"plugins/log","title":"Log Plugin","description":"The Log plugin provides comprehensive request and response logging for your Balda.js application. It automatically logs HTTP requests and responses with configurable detail levels and can be used both globally and on specific routes.","source":"@site/docs/plugins/log.md","sourceDirName":"plugins","slug":"/plugins/log","permalink":"/balda-js/docs/plugins/log","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda-js/tree/main/docs/docs/plugins/log.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8}}');var o=s(4848),t=s(8453);const l={sidebar_position:8},i="Log Plugin",a={},d=[{value:"Features",id:"features",level:2},{value:"Basic Configuration",id:"basic-configuration",level:2},{value:"Simple Setup",id:"simple-setup",level:3},{value:"Detailed Configuration",id:"detailed-configuration",level:3},{value:"Configuration Options",id:"configuration-options",level:2},{value:"Basic Options",id:"basic-options",level:3},{value:"Advanced Configuration",id:"advanced-configuration",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Global Logging",id:"global-logging",level:3},{value:"Route-Level Logging",id:"route-level-logging",level:3},{value:"Different Logging Levels",id:"different-logging-levels",level:3},{value:"Conditional Logging",id:"conditional-logging",level:3},{value:"Log Output Examples",id:"log-output-examples",level:2},{value:"Request Log",id:"request-log",level:3},{value:"Response Log",id:"response-log",level:3},{value:"Minimal Log",id:"minimal-log",level:3},{value:"Environment-Based Configuration",id:"environment-based-configuration",level:2},{value:"Development vs Production",id:"development-vs-production",level:3},{value:"Different Logging for Different Routes",id:"different-logging-for-different-routes",level:3},{value:"Performance Monitoring",id:"performance-monitoring",level:2},{value:"Request Timing",id:"request-timing",level:3},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Sensitive Data Filtering",id:"sensitive-data-filtering",level:3},{value:"Integration with Other Plugins",id:"integration-with-other-plugins",level:2},{value:"With Error Handling",id:"with-error-handling",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Logging Recommendations",id:"logging-recommendations",level:3},{value:"Configuration Tips",id:"configuration-tips",level:3},{value:"Monitoring and Alerting",id:"monitoring-and-alerting",level:3}];function u(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"log-plugin",children:"Log Plugin"})}),"\n",(0,o.jsx)(n.p,{children:"The Log plugin provides comprehensive request and response logging for your Balda.js application. It automatically logs HTTP requests and responses with configurable detail levels and can be used both globally and on specific routes."}),"\n",(0,o.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Request Logging"}),": Log incoming requests with customizable detail"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Response Logging"}),": Log outgoing responses with status and body"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Configurable Detail"}),": Choose what information to log"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Global and Route-Level"}),": Apply logging globally or to specific routes"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Structured Logging"}),": JSON-formatted logs for easy parsing"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Performance Monitoring"}),": Track request timing and performance"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"basic-configuration",children:"Basic Configuration"}),"\n",(0,o.jsx)(n.h3,{id:"simple-setup",children:"Simple Setup"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"import { Server } from 'balda-js';\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    log: {\n      logRequest: true,\n      logResponse: true\n    }\n  }\n});\n"})}),"\n",(0,o.jsx)(n.h3,{id:"detailed-configuration",children:"Detailed Configuration"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  port: 3000,\n  plugins: {\n    log: {\n      logRequest: true,\n      logResponse: true,\n      requestPayload: {\n        method: true,\n        url: true,\n        ip: true,\n        headers: true,\n        body: false\n      },\n      responsePayload: {\n        status: true,\n        headers: false,\n        body: false\n      }\n    }\n  }\n});\n"})}),"\n",(0,o.jsx)(n.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,o.jsx)(n.h3,{id:"basic-options",children:"Basic Options"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"log: {\n  logRequest: true,           // Enable request logging (default: true)\n  logResponse: true,          // Enable response logging (default: true)\n  requestPayload: {\n    method: true,             // Log HTTP method (default: true)\n    url: true,                // Log request URL (default: true)\n    ip: true,                 // Log client IP (default: true)\n    headers: true,            // Log request headers (default: true)\n    body: false               // Log request body (default: false)\n  },\n  responsePayload: {\n    status: true,             // Log response status (default: true)\n    headers: false,           // Log response headers (default: false)\n    body: false               // Log response body (default: false)\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"advanced-configuration",children:"Advanced Configuration"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"log: {\n  logRequest: true,\n  logResponse: true,\n  requestPayload: {\n    method: true,\n    url: true,\n    ip: true,\n    headers: false, // Don't log headers for privacy\n    body: false\n  },\n  responsePayload: {\n    status: true,\n    headers: false,\n    body: false\n  },\n  pinoOptions: {\n    level: 'info',\n    prettyPrint: true\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,o.jsx)(n.h3,{id:"global-logging",children:"Global Logging"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  port: 3000,\n  plugins: {\n    log: {\n      logRequest: true,\n      logResponse: true,\n      requestPayload: {\n        method: true,\n        url: true,\n        ip: true,\n        headers: false,\n        body: false\n      },\n      responsePayload: {\n        status: true,\n        headers: false,\n        body: false\n      }\n    }\n  }\n});\n\n@controller('/api')\nexport class ApiController {\n  @get('/users')\n  async getUsers(req: Request, res: Response) {\n    // All requests and responses will be logged automatically\n    const users = await getUsers();\n    res.json(users);\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"route-level-logging",children:"Route-Level Logging"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class ApiController {\n  @get('/public', {\n    middleware: [log({\n      logRequest: true,\n      logResponse: true,\n      requestPayload: {\n        method: true,\n        url: true,\n        ip: true,\n        headers: false,\n        body: false\n      }\n    })]\n  })\n  async publicEndpoint(req: Request, res: Response) {\n    // Only this route will be logged\n    res.json({ message: 'Public endpoint' });\n  }\n\n  @get('/private')\n  async privateEndpoint(req: Request, res: Response) {\n    // This route won't be logged\n    res.json({ message: 'Private endpoint' });\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"different-logging-levels",children:"Different Logging Levels"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class LoggingController {\n  @get('/minimal', {\n    middleware: [log({\n      logRequest: true,\n      logResponse: true,\n      requestPayload: {\n        method: true,\n        url: true,\n        ip: false,\n        headers: false,\n        body: false\n      },\n      responsePayload: {\n        status: true,\n        headers: false,\n        body: false\n      }\n    })]\n  })\n  async minimalLogging(req: Request, res: Response) {\n    res.json({ message: 'Minimal logging' });\n  }\n\n  @get('/detailed', {\n    middleware: [log({\n      logRequest: true,\n      logResponse: true,\n      requestPayload: {\n        method: true,\n        url: true,\n        ip: true,\n        headers: true,\n        body: true\n      },\n      responsePayload: {\n        status: true,\n        headers: true,\n        body: true\n      }\n    })]\n  })\n  async detailedLogging(req: Request, res: Response) {\n    res.json({ message: 'Detailed logging' });\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"conditional-logging",children:"Conditional Logging"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class ConditionalController {\n  @get('/conditional', {\n    middleware: [log({\n      logRequest: true,\n      logResponse: (req, res) => {\n        // Only log responses with status >= 400\n        return res.responseStatus >= 400;\n      },\n      requestPayload: {\n        method: true,\n        url: true,\n        ip: true,\n        headers: false,\n        body: false\n      },\n      responsePayload: {\n        status: true,\n        headers: false,\n        body: true // Log body for errors\n      }\n    })]\n  })\n  async conditionalLogging(req: Request, res: Response) {\n    if (Math.random() > 0.5) {\n      res.status(500).json({ error: 'Random error' });\n    } else {\n      res.json({ message: 'Success' });\n    }\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"log-output-examples",children:"Log Output Examples"}),"\n",(0,o.jsx)(n.h3,{id:"request-log",children:"Request Log"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "level": "info",\n  "time": "2024-01-15T10:30:00.000Z",\n  "type": "request",\n  "requestId": "req-123",\n  "method": "POST",\n  "url": "/api/users",\n  "ip": "192.168.1.100",\n  "headers": {\n    "content-type": "application/json",\n    "authorization": "Bearer token123"\n  },\n  "body": {\n    "name": "John Doe",\n    "email": "john@example.com"\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"response-log",children:"Response Log"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "level": "info",\n  "time": "2024-01-15T10:30:01.000Z",\n  "type": "response",\n  "requestId": "req-123",\n  "status": 201,\n  "headers": {\n    "content-type": "application/json"\n  },\n  "body": {\n    "id": 123,\n    "name": "John Doe",\n    "email": "john@example.com"\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"minimal-log",children:"Minimal Log"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "level": "info",\n  "time": "2024-01-15T10:30:00.000Z",\n  "type": "request",\n  "requestId": "req-123",\n  "method": "GET",\n  "url": "/api/users"\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"environment-based-configuration",children:"Environment-Based Configuration"}),"\n",(0,o.jsx)(n.h3,{id:"development-vs-production",children:"Development vs Production"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"const isProduction = process.env.NODE_ENV === 'production';\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    log: {\n      logRequest: true,\n      logResponse: true,\n      requestPayload: {\n        method: true,\n        url: true,\n        ip: true,\n        headers: !isProduction, // Don't log headers in production\n        body: !isProduction     // Don't log bodies in production\n      },\n      responsePayload: {\n        status: true,\n        headers: false,\n        body: !isProduction     // Don't log response bodies in production\n      },\n      pinoOptions: {\n        level: isProduction ? 'info' : 'debug',\n        prettyPrint: !isProduction\n      }\n    }\n  }\n});\n"})}),"\n",(0,o.jsx)(n.h3,{id:"different-logging-for-different-routes",children:"Different Logging for Different Routes"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class DifferentLoggingController {\n  @get('/public', {\n    middleware: [log({\n      logRequest: true,\n      logResponse: true,\n      requestPayload: {\n        method: true,\n        url: true,\n        ip: true,\n        headers: false,\n        body: false\n      }\n    })]\n  })\n  async publicEndpoint(req: Request, res: Response) {\n    res.json({ message: 'Public endpoint' });\n  }\n\n  @get('/admin', {\n    middleware: [log({\n      logRequest: true,\n      logResponse: true,\n      requestPayload: {\n        method: true,\n        url: true,\n        ip: true,\n        headers: true,\n        body: true\n      },\n      responsePayload: {\n        status: true,\n        headers: true,\n        body: true\n      }\n    })]\n  })\n  async adminEndpoint(req: Request, res: Response) {\n    res.json({ message: 'Admin endpoint' });\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"performance-monitoring",children:"Performance Monitoring"}),"\n",(0,o.jsx)(n.h3,{id:"request-timing",children:"Request Timing"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class PerformanceController {\n  @get('/slow', {\n    middleware: [log({\n      logRequest: true,\n      logResponse: true,\n      requestPayload: {\n        method: true,\n        url: true,\n        ip: true,\n        headers: false,\n        body: false\n      },\n      responsePayload: {\n        status: true,\n        headers: false,\n        body: false\n      }\n    })]\n  })\n  async slowEndpoint(req: Request, res: Response) {\n    // Simulate slow operation\n    await new Promise(resolve => setTimeout(resolve, 2000));\n    res.json({ message: 'Slow response' });\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,o.jsx)(n.h3,{id:"sensitive-data-filtering",children:"Sensitive Data Filtering"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class SecureController {\n  @post('/login', {\n    middleware: [log({\n      logRequest: true,\n      logResponse: true,\n      requestPayload: {\n        method: true,\n        url: true,\n        ip: true,\n        headers: false, // Don't log auth headers\n        body: false     // Don't log passwords\n      },\n      responsePayload: {\n        status: true,\n        headers: false,\n        body: false     // Don't log tokens\n      }\n    })]\n  })\n  async login(req: Request, res: Response) {\n    // Authentication logic\n    res.json({ token: 'secret-token' });\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"integration-with-other-plugins",children:"Integration with Other Plugins"}),"\n",(0,o.jsx)(n.h3,{id:"with-error-handling",children:"With Error Handling"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class ErrorController {\n  @get('/error', {\n    middleware: [log({\n      logRequest: true,\n      logResponse: true,\n      requestPayload: {\n        method: true,\n        url: true,\n        ip: true,\n        headers: false,\n        body: false\n      },\n      responsePayload: {\n        status: true,\n        headers: false,\n        body: true // Log error responses\n      }\n    })]\n  })\n  async errorEndpoint(req: Request, res: Response) {\n    try {\n      throw new Error('Something went wrong');\n    } catch (error) {\n      res.status(500).json({ error: error.message });\n    }\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,o.jsx)(n.h3,{id:"logging-recommendations",children:"Logging Recommendations"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Don't Log Sensitive Data"}),": Avoid logging passwords, tokens, PII"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Use Appropriate Detail Levels"}),": Different levels for different environments"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Monitor Log Volume"}),": Be aware of log storage and performance impact"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Structured Logging"}),": Use JSON format for easy parsing"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Request ID Tracking"}),": Use request IDs to correlate logs"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"configuration-tips",children:"Configuration Tips"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"// Production configuration\nconst productionLogConfig = {\n  logRequest: true,\n  logResponse: true,\n  requestPayload: {\n    method: true,\n    url: true,\n    ip: true,\n    headers: false, // Privacy\n    body: false     // Security\n  },\n  responsePayload: {\n    status: true,\n    headers: false,\n    body: false     // Security\n  },\n  pinoOptions: {\n    level: 'info',\n    prettyPrint: false\n  }\n};\n\n// Development configuration\nconst developmentLogConfig = {\n  logRequest: true,\n  logResponse: true,\n  requestPayload: {\n    method: true,\n    url: true,\n    ip: true,\n    headers: true,\n    body: true\n  },\n  responsePayload: {\n    status: true,\n    headers: true,\n    body: true\n  },\n  pinoOptions: {\n    level: 'debug',\n    prettyPrint: true\n  }\n};\n"})}),"\n",(0,o.jsx)(n.h3,{id:"monitoring-and-alerting",children:"Monitoring and Alerting"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class MonitoredController {\n  @get('/monitored', {\n    middleware: [log({\n      logRequest: true,\n      logResponse: true,\n      requestPayload: {\n        method: true,\n        url: true,\n        ip: true,\n        headers: false,\n        body: false\n      },\n      responsePayload: {\n        status: true,\n        headers: false,\n        body: false\n      },\n      onError: (error, req, res) => {\n        // Send alert for errors\n        alertService.sendAlert(`Error in ${req.url}: ${error.message}`);\n      }\n    })]\n  })\n  async monitoredEndpoint(req: Request, res: Response) {\n    res.json({ message: 'Monitored endpoint' });\n  }\n}\n"})})]})}function g(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}}}]);