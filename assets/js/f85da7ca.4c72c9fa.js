"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[962],{3607:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"plugins/rate-limiter","title":"Rate Limiter Plugin","description":"The Rate Limiter plugin helps protect your Balda.js application from abuse by limiting the number of requests a client can make within a specified time window. It supports both IP-based and custom key-based rate limiting with flexible storage options.","source":"@site/docs/plugins/rate-limiter.md","sourceDirName":"plugins","slug":"/plugins/rate-limiter","permalink":"/balda-js/docs/plugins/rate-limiter","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda-js/tree/main/docs/docs/plugins/rate-limiter.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7}}');var s=i(4848),r=i(8453);const a={sidebar_position:7},o="Rate Limiter Plugin",l={},d=[{value:"Features",id:"features",level:2},{value:"Basic Configuration",id:"basic-configuration",level:2},{value:"Simple IP-Based Limiting",id:"simple-ip-based-limiting",level:3},{value:"Custom Key-Based Limiting",id:"custom-key-based-limiting",level:3},{value:"Configuration Options",id:"configuration-options",level:2},{value:"IP-Based Rate Limiting",id:"ip-based-rate-limiting",level:3},{value:"Custom Key-Based Rate Limiting",id:"custom-key-based-rate-limiting",level:3},{value:"Storage Configuration",id:"storage-configuration",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Basic Rate Limiting",id:"basic-rate-limiting",level:3},{value:"Different Limits for Different Endpoints",id:"different-limits-for-different-endpoints",level:3},{value:"User-Based Rate Limiting",id:"user-based-rate-limiting",level:3},{value:"API Key-Based Rate Limiting",id:"api-key-based-rate-limiting",level:3},{value:"Advanced Configuration",id:"advanced-configuration",level:2},{value:"Multiple Rate Limiters",id:"multiple-rate-limiters",level:3},{value:"Custom Storage Implementation",id:"custom-storage-implementation",level:3},{value:"Environment-Based Configuration",id:"environment-based-configuration",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Rate Limit Exceeded Response",id:"rate-limit-exceeded-response",level:3},{value:"Custom Error Handling",id:"custom-error-handling",level:3},{value:"Storage Strategies",id:"storage-strategies",level:2},{value:"In-Memory Storage (Default)",id:"in-memory-storage-default",level:3},{value:"Custom Storage",id:"custom-storage",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"rate-limiter-plugin",children:"Rate Limiter Plugin"})}),"\n",(0,s.jsx)(n.p,{children:"The Rate Limiter plugin helps protect your Balda.js application from abuse by limiting the number of requests a client can make within a specified time window. It supports both IP-based and custom key-based rate limiting with flexible storage options."}),"\n",(0,s.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"IP-Based Limiting"}),": Limit requests per IP address"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Custom Key Limiting"}),": Limit requests based on custom criteria (user ID, API key, etc.)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Flexible Storage"}),": In-memory storage with custom storage support"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Configurable Limits"}),": Set custom request limits and time windows"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Customizable Responses"}),": Configure error messages and status codes"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"basic-configuration",children:"Basic Configuration"}),"\n",(0,s.jsx)(n.h3,{id:"simple-ip-based-limiting",children:"Simple IP-Based Limiting"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { Server } from 'balda-js';\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    rateLimiter: {\n      type: \"ip\",\n      limit: 100,\n      windowMs: 60000 // 1 minute\n    }\n  }\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"custom-key-based-limiting",children:"Custom Key-Based Limiting"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  port: 3000,\n  plugins: {\n    rateLimiter: {\n      type: \"custom\",\n      key: (req) => req.headers.get('X-API-Key') || req.ip,\n      limit: 50,\n      windowMs: 60000\n    }\n  }\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,s.jsx)(n.h3,{id:"ip-based-rate-limiting",children:"IP-Based Rate Limiting"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'rateLimiter: {\n  type: "ip",\n  limit: 100,                    // Requests per window\n  windowMs: 60000,              // Time window in milliseconds\n  message: "Too many requests",  // Custom error message\n  statusCode: 429               // Custom status code\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"custom-key-based-rate-limiting",children:"Custom Key-Based Rate Limiting"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'rateLimiter: {\n  type: "custom",\n  key: (req) => {\n    // Custom key generation logic\n    return req.headers.get(\'X-API-Key\') || req.ip;\n  },\n  limit: 50,\n  windowMs: 60000,\n  message: "Rate limit exceeded",\n  statusCode: 429\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"storage-configuration",children:"Storage Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'rateLimiter: {\n  type: "ip",\n  limit: 100,\n  windowMs: 60000,\n  storageStrategy: "memory", // Default: "memory"\n  // For custom storage:\n  storageStrategy: "custom",\n  get: async (key) => { /* custom get logic */ },\n  set: async (key, value) => { /* custom set logic */ }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,s.jsx)(n.h3,{id:"basic-rate-limiting",children:"Basic Rate Limiting"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  port: 3000,\n  plugins: {\n    rateLimiter: {\n      type: \"ip\",\n      limit: 100,\n      windowMs: 60000 // 1 minute\n    }\n  }\n});\n\n@controller('/api')\nexport class ApiController {\n  @get('/users')\n  async getUsers(req: Request, res: Response) {\n    // This endpoint is rate limited to 100 requests per minute per IP\n    const users = await getUsers();\n    res.json(users);\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"different-limits-for-different-endpoints",children:"Different Limits for Different Endpoints"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class ApiController {\n  @get('/public', {\n    middleware: [rateLimiter({\n      type: \"ip\",\n      limit: 1000,\n      windowMs: 60000\n    })]\n  })\n  async publicEndpoint(req: Request, res: Response) {\n    // 1000 requests per minute\n    res.json({ message: 'Public endpoint' });\n  }\n\n  @get('/sensitive', {\n    middleware: [rateLimiter({\n      type: \"ip\",\n      limit: 10,\n      windowMs: 60000\n    })]\n  })\n  async sensitiveEndpoint(req: Request, res: Response) {\n    // 10 requests per minute\n    res.json({ message: 'Sensitive endpoint' });\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"user-based-rate-limiting",children:"User-Based Rate Limiting"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class UserController {\n  @get('/profile', {\n    middleware: [rateLimiter({\n      type: \"custom\",\n      key: (req) => {\n        // Rate limit by user ID from JWT token\n        const token = req.headers.get('Authorization')?.replace('Bearer ', '');\n        const decoded = jwt.verify(token, process.env.JWT_SECRET);\n        return decoded.userId;\n      },\n      limit: 50,\n      windowMs: 60000\n    })]\n  })\n  async getProfile(req: Request, res: Response) {\n    // 50 requests per minute per user\n    const profile = await getUserProfile(req.user.id);\n    res.json(profile);\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"api-key-based-rate-limiting",children:"API Key-Based Rate Limiting"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class ApiKeyController {\n  @get('/data', {\n    middleware: [rateLimiter({\n      type: \"custom\",\n      key: (req) => req.headers.get('X-API-Key'),\n      limit: 1000,\n      windowMs: 60000\n    })]\n  })\n  async getData(req: Request, res: Response) {\n    // 1000 requests per minute per API key\n    const data = await getData();\n    res.json(data);\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"advanced-configuration",children:"Advanced Configuration"}),"\n",(0,s.jsx)(n.h3,{id:"multiple-rate-limiters",children:"Multiple Rate Limiters"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class AdvancedController {\n  @get('/complex', {\n    middleware: [\n      // IP-based rate limiting\n      rateLimiter({\n        type: \"ip\",\n        limit: 100,\n        windowMs: 60000\n      }),\n      // User-based rate limiting\n      rateLimiter({\n        type: \"custom\",\n        key: (req) => req.user?.id || req.ip,\n        limit: 20,\n        windowMs: 60000\n      })\n    ]\n  })\n  async complexEndpoint(req: Request, res: Response) {\n    // Must pass both rate limiters\n    res.json({ message: 'Complex endpoint' });\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"custom-storage-implementation",children:"Custom Storage Implementation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'// Redis storage example\nconst redisStorage = {\n  get: async (key: string) => {\n    const value = await redis.get(`rate_limit:${key}`);\n    return value ? parseInt(value) : 0;\n  },\n  set: async (key: string, value: number) => {\n    await redis.setex(`rate_limit:${key}`, 60, value.toString());\n  }\n};\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    rateLimiter: {\n      type: "ip",\n      limit: 100,\n      windowMs: 60000,\n      storageStrategy: "custom",\n      get: redisStorage.get,\n      set: redisStorage.set\n    }\n  }\n});\n'})}),"\n",(0,s.jsx)(n.h3,{id:"environment-based-configuration",children:"Environment-Based Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const isProduction = process.env.NODE_ENV === \'production\';\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    rateLimiter: {\n      type: "ip",\n      limit: isProduction ? 100 : 1000, // Stricter in production\n      windowMs: 60000,\n      message: isProduction ? "Rate limit exceeded" : "Too many requests",\n      statusCode: 429\n    }\n  }\n});\n'})}),"\n",(0,s.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,s.jsx)(n.h3,{id:"rate-limit-exceeded-response",children:"Rate Limit Exceeded Response"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'// Default response when rate limit is exceeded\n{\n  "message": "ERR_RATE_LIMIT_EXCEEDED"\n}\n\n// Custom response\n{\n  "message": "Too many requests, please try again later"\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"custom-error-handling",children:"Custom Error Handling"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@controller('/api')\nexport class ErrorController {\n  @get('/limited', {\n    middleware: [rateLimiter({\n      type: \"ip\",\n      limit: 5,\n      windowMs: 60000,\n      message: \"You've exceeded the rate limit\",\n      statusCode: 429\n    })]\n  })\n  async limitedEndpoint(req: Request, res: Response) {\n    res.json({ message: 'Success' });\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"storage-strategies",children:"Storage Strategies"}),"\n",(0,s.jsx)(n.h3,{id:"in-memory-storage-default",children:"In-Memory Storage (Default)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'rateLimiter: {\n  type: "ip",\n  limit: 100,\n  windowMs: 60000,\n  storageStrategy: "memory" // Default\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"custom-storage",children:"Custom Storage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'rateLimiter: {\n  type: "ip",\n  limit: 100,\n  windowMs: 60000,\n  storageStrategy: "custom",\n  get: async (key: string) => {\n    // Custom get implementation\n    return await yourStorage.get(key);\n  },\n  set: async (key: string, value: number) => {\n    // Custom set implementation\n    await yourStorage.set(key, value, 60); // 60 seconds TTL\n  }\n}\n'})})]})}function m(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>o});var t=i(6540);const s={},r=t.createContext(s);function a(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);