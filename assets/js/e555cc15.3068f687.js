"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1031],{247:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"plugins/cors","title":"CORS Plugin","description":"Enables Cross-Origin Resource Sharing (CORS) in your application. Handles preflight requests and sets appropriate CORS headers for both simple and complex requests.","source":"@site/docs/plugins/cors.md","sourceDirName":"plugins","slug":"/plugins/cors","permalink":"/balda/docs/plugins/cors","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda/tree/main/docs/docs/plugins/cors.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docs","previous":{"title":"File Plugin","permalink":"/balda/docs/plugins/file"},"next":{"title":"Helmet Plugin","permalink":"/balda/docs/plugins/helmet"}}');var i=s(4848),o=s(8453);const l={sidebar_position:2},t="CORS Plugin",c={},d=[{value:"Quick Start",id:"quick-start",level:2},{value:"Configuration",id:"configuration",level:2},{value:"origin",id:"origin",level:3},{value:"methods",id:"methods",level:3},{value:"allowedHeaders",id:"allowedheaders",level:3},{value:"exposedHeaders",id:"exposedheaders",level:3},{value:"credentials",id:"credentials",level:3},{value:"maxAge",id:"maxage",level:3},{value:"Complete Configuration",id:"complete-configuration",level:3},{value:"Route-Level CORS",id:"route-level-cors",level:2},{value:"Environment-Based Configuration",id:"environment-based-configuration",level:2},{value:"Security Considerations",id:"security-considerations",level:2},{value:"\u274c Wildcard with Credentials",id:"-wildcard-with-credentials",level:3},{value:"\u2705 Specific Origins with Credentials",id:"-specific-origins-with-credentials",level:3},{value:"Production Configuration",id:"production-configuration",level:3},{value:"CORS Headers",id:"cors-headers",level:2},{value:"Request Headers (from browser)",id:"request-headers-from-browser",level:3},{value:"Response Headers (from server)",id:"response-headers-from-server",level:3},{value:"Preflight Requests",id:"preflight-requests",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"cors-plugin",children:"CORS Plugin"})}),"\n",(0,i.jsx)(n.p,{children:"Enables Cross-Origin Resource Sharing (CORS) in your application. Handles preflight requests and sets appropriate CORS headers for both simple and complex requests."}),"\n",(0,i.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { Server } from 'balda';\n\nconst server = new Server({\n  plugins: {\n    cors: {\n      origin: ['http://localhost:3000'],\n      credentials: true\n    }\n  }\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(n.h3,{id:"origin",children:"origin"}),"\n",(0,i.jsx)(n.p,{children:"Configure allowed origins:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Allow all origins (development only)\ncors: {\n  origin: '*'\n}\n\n// Allow specific origins\ncors: {\n  origin: ['https://myapp.com', 'https://admin.myapp.com']\n}\n\n// Allow origins with regex\ncors: {\n  origin: ['https://myapp.com', /^https:\\/\\/.*\\.myapp\\.com$/]\n}\n\n// Function-based validation\ncors: {\n  origin: (origin) => {\n    const allowedOrigins = ['https://myapp.com'];\n    return allowedOrigins.includes(origin);\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"methods",children:"methods"}),"\n",(0,i.jsx)(n.p,{children:"Configure allowed HTTP methods:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Default\ncors: {\n  methods: ['GET', 'HEAD', 'PUT', 'PATCH', 'POST', 'DELETE']\n}\n\n// Custom\ncors: {\n  methods: ['GET', 'POST', 'PUT', 'DELETE']\n}\n\n// String format\ncors: {\n  methods: 'GET,POST,PUT,DELETE'\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"allowedheaders",children:"allowedHeaders"}),"\n",(0,i.jsx)(n.p,{children:"Configure allowed request headers:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Specific headers\ncors: {\n  allowedHeaders: ['Content-Type', 'Authorization', 'X-API-Key']\n}\n\n// Allow all\ncors: {\n  allowedHeaders: '*'\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"exposedheaders",children:"exposedHeaders"}),"\n",(0,i.jsx)(n.p,{children:"Expose response headers to the client:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"cors: {\n  exposedHeaders: ['X-Total-Count', 'X-Page-Count']\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"credentials",children:"credentials"}),"\n",(0,i.jsx)(n.p,{children:"Enable credentials (cookies, authorization headers):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"cors: {\n  origin: ['https://myapp.com'],  // Required with credentials\n  credentials: true\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"maxage",children:"maxAge"}),"\n",(0,i.jsx)(n.p,{children:"Cache preflight results (in seconds):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"cors: {\n  maxAge: 86400  // 24 hours\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"complete-configuration",children:"Complete Configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  plugins: {\n    cors: {\n      origin: ['https://myapp.com'],\n      methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],\n      allowedHeaders: ['Content-Type', 'Authorization'],\n      exposedHeaders: ['X-Total-Count'],\n      credentials: true,\n      maxAge: 86400,\n      preflightContinue: false,\n      optionsSuccessStatus: 204\n    }\n  }\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"route-level-cors",children:"Route-Level CORS"}),"\n",(0,i.jsx)(n.p,{children:"Apply CORS to specific routes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { cors } from 'balda';\n\n@controller('/api')\nexport class ApiController {\n  @get('/public', {\n    middleware: [cors({ origin: '*' })]\n  })\n  async publicEndpoint(req: Request, res: Response) {\n    res.json({ message: 'Public endpoint' });\n  }\n\n  @get('/private', {\n    middleware: [cors({\n      origin: ['https://myapp.com'],\n      credentials: true\n    })]\n  })\n  async privateEndpoint(req: Request, res: Response) {\n    res.json({ message: 'Private endpoint' });\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"environment-based-configuration",children:"Environment-Based Configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const isProduction = process.env.NODE_ENV === 'production';\n\nconst server = new Server({\n  plugins: {\n    cors: {\n      origin: isProduction\n        ? process.env.ALLOWED_ORIGINS?.split(',')\n        : ['http://localhost:3000'],\n      credentials: isProduction,\n      maxAge: isProduction ? 86400 : undefined\n    }\n  }\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,i.jsx)(n.h3,{id:"-wildcard-with-credentials",children:"\u274c Wildcard with Credentials"}),"\n",(0,i.jsx)(n.p,{children:"This doesn't work - credentials require specific origins:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"cors: {\n  origin: '*',\n  credentials: true  // Error!\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"-specific-origins-with-credentials",children:"\u2705 Specific Origins with Credentials"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"cors: {\n  origin: ['https://myapp.com', 'https://admin.myapp.com'],\n  credentials: true  // Works!\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"production-configuration",children:"Production Configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"cors: {\n  origin: ['https://myapp.com'],  // Specific origins only\n  credentials: true,\n  methods: ['GET', 'POST', 'PUT', 'DELETE'],\n  allowedHeaders: ['Content-Type', 'Authorization'],\n  maxAge: 86400\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"cors-headers",children:"CORS Headers"}),"\n",(0,i.jsx)(n.h3,{id:"request-headers-from-browser",children:"Request Headers (from browser)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Origin"})," - The origin of the request"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Access-Control-Request-Method"})," - HTTP method for actual request"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Access-Control-Request-Headers"})," - Headers for actual request"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"response-headers-from-server",children:"Response Headers (from server)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Access-Control-Allow-Origin"})," - Allowed origins"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Access-Control-Allow-Methods"})," - Allowed HTTP methods"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Access-Control-Allow-Headers"})," - Allowed headers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Access-Control-Expose-Headers"})," - Headers exposed to client"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Access-Control-Allow-Credentials"})," - Whether credentials allowed"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Access-Control-Max-Age"})," - Preflight cache duration"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"preflight-requests",children:"Preflight Requests"}),"\n",(0,i.jsx)(n.p,{children:"CORS automatically handles preflight OPTIONS requests:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",children:"OPTIONS /api/users\nOrigin: https://myapp.com\nAccess-Control-Request-Method: POST\nAccess-Control-Request-Headers: Content-Type, Authorization\n\n\u2192 Response:\nAccess-Control-Allow-Origin: https://myapp.com\nAccess-Control-Allow-Methods: GET, POST, PUT, DELETE, PATCH\nAccess-Control-Allow-Headers: Content-Type, Authorization\nAccess-Control-Max-Age: 86400\n"})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>t});var r=s(6540);const i={},o=r.createContext(i);function l(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);