"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5944],{6035:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>c,frontMatter:()=>t,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"plugins/file","title":"File Plugin","description":"The File plugin handles multipart/form-data file uploads in your Balda.js application. It automatically parses uploaded files, validates them against size limits, and provides convenient access to file data through req.files and req.file.","source":"@site/docs/plugins/file.md","sourceDirName":"plugins","slug":"/plugins/file","permalink":"/balda-js/docs/plugins/file","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda-js/tree/main/docs/docs/plugins/file.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10}}');var a=i(4848),s=i(8453);const t={sidebar_position:10},o="File Plugin",r={},d=[{value:"Features",id:"features",level:2},{value:"Basic Configuration",id:"basic-configuration",level:2},{value:"Simple Setup",id:"simple-setup",level:3},{value:"Advanced Configuration",id:"advanced-configuration",level:3},{value:"Configuration Options",id:"configuration-options",level:2},{value:"Size Limit",id:"size-limit",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Basic File Upload",id:"basic-file-upload",level:3},{value:"Multiple File Upload",id:"multiple-file-upload",level:3},{value:"File Upload with Form Data",id:"file-upload-with-form-data",level:3},{value:"Image Upload with Validation",id:"image-upload-with-validation",level:3},{value:"File Object Properties",id:"file-object-properties",level:2},{value:"File Structure",id:"file-structure",level:3},{value:"Accessing File Properties",id:"accessing-file-properties",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"File Too Large",id:"file-too-large",level:3},{value:"No Files Uploaded",id:"no-files-uploaded",level:3},{value:"Invalid File Type",id:"invalid-file-type",level:3},{value:"File Processing Examples",id:"file-processing-examples",level:2},{value:"Moving Files to Permanent Location",id:"moving-files-to-permanent-location",level:3},{value:"HTML Form Examples",id:"html-form-examples",level:2},{value:"Single File Upload",id:"single-file-upload",level:3},{value:"Multiple File Upload",id:"multiple-file-upload-1",level:3},{value:"File Upload with Form Data",id:"file-upload-with-form-data-1",level:3}];function p(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"file-plugin",children:"File Plugin"})}),"\n",(0,a.jsxs)(n.p,{children:["The File plugin handles multipart/form-data file uploads in your Balda.js application. It automatically parses uploaded files, validates them against size limits, and provides convenient access to file data through ",(0,a.jsx)(n.code,{children:"req.files"})," and ",(0,a.jsx)(n.code,{children:"req.file"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Multipart Form Data"}),": Handles file uploads from HTML forms"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Size Validation"}),": Configurable file size limits"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Automatic Cleanup"}),": Temporary files are cleaned up automatically"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Multiple Files"}),": Support for single and multiple file uploads"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"File Metadata"}),": Access to file name, size, MIME type, and temporary path"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Error Handling"}),": Graceful handling of file upload errors"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"basic-configuration",children:"Basic Configuration"}),"\n",(0,a.jsx)(n.h3,{id:"simple-setup",children:"Simple Setup"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"import { Server } from 'balda-js';\n\nconst server = new Server({\n  port: 3000,\n  plugins: {\n    fileParser: {\n      maxFileSize: 5 * 1024 * 1024 // 5MB\n    }\n  }\n});\n"})}),"\n",(0,a.jsx)(n.h3,{id:"advanced-configuration",children:"Advanced Configuration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"const server = new Server({\n  port: 3000,\n  plugins: {\n    fileParser: {\n      maxFileSize: 10 * 1024 * 1024 // 10MB\n    }\n  }\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,a.jsx)(n.h3,{id:"size-limit",children:"Size Limit"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"fileParser: {\n  maxFileSize: 5 * 1024 * 1024 // Maximum file size in bytes (default: none)\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Note"}),": If you need to validate MIME types, number of files, or other constraints, implement validation logic in your controller after the files are uploaded."]}),"\n",(0,a.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,a.jsx)(n.h3,{id:"basic-file-upload",children:"Basic File Upload"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"@controller('/upload')\nexport class UploadController {\n  @post('/single')\n  async uploadSingleFile(req: Request, res: Response) {\n    if (!req.files || req.files.length === 0) {\n      return res.badRequest({ error: 'No file uploaded' });\n    }\n\n    const file = req.files[0];\n\n    // Access file properties\n    console.log('File name:', file.originalName);\n    console.log('File size:', file.size);\n    console.log('MIME type:', file.mimeType);\n    console.log('Temporary path:', file.tmpPath);\n\n    // Process the file (e.g., move to permanent location)\n    const permanentPath = await moveFileToPermanentLocation(file.tmpPath, file.originalName);\n\n    res.json({\n      message: 'File uploaded successfully',\n      file: {\n        name: file.originalName,\n        size: file.size,\n        path: permanentPath\n      }\n    });\n  }\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"multiple-file-upload",children:"Multiple File Upload"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"@controller('/upload')\nexport class UploadController {\n  @post('/multiple')\n  async uploadMultipleFiles(req: Request, res: Response) {\n    if (!req.files || req.files.length === 0) {\n      return res.badRequest({ error: 'No files uploaded' });\n    }\n\n    const uploadedFiles = [];\n\n    for (const file of req.files) {\n      // Process each file\n      const permanentPath = await moveFileToPermanentLocation(file.tmpPath, file.originalName);\n\n      uploadedFiles.push({\n        name: file.originalName,\n        size: file.size,\n        mimeType: file.mimeType,\n        path: permanentPath\n      });\n    }\n\n    res.json({\n      message: `${uploadedFiles.length} files uploaded successfully`,\n      files: uploadedFiles\n    });\n  }\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"file-upload-with-form-data",children:"File Upload with Form Data"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"@controller('/upload')\nexport class UploadController {\n  @post('/with-data')\n  async uploadWithData(req: Request, res: Response) {\n    // Access uploaded files\n    const files = req.files || [];\n\n    // Access form data\n    const title = req.body.title;\n    const description = req.body.description;\n    const category = req.body.category;\n\n    if (files.length === 0) {\n      return res.badRequest({ error: 'No file uploaded' });\n    }\n\n    const file = files[0];\n\n    // Save file and metadata to database\n    const savedFile = await saveFileToDatabase({\n      title,\n      description,\n      category,\n      fileName: file.originalName,\n      fileSize: file.size,\n      mimeType: file.mimeType,\n      filePath: await moveFileToPermanentLocation(file.tmpPath, file.originalName)\n    });\n\n    res.json({\n      message: 'File uploaded with metadata',\n      file: savedFile\n    });\n  }\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"image-upload-with-validation",children:"Image Upload with Validation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"@controller('/upload')\nexport class ImageController {\n  @post('/image')\n  async uploadImage(req: Request, res: Response) {\n    if (!req.files || req.files.length === 0) {\n      return res.badRequest({ error: 'No image uploaded' });\n    }\n\n    const file = req.files[0];\n\n    // Validate image type\n    const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];\n    if (!allowedTypes.includes(file.mimeType)) {\n      return res.badRequest({\n        error: 'Invalid file type. Only JPEG, PNG, GIF, and WebP are allowed.'\n      });\n    }\n\n    // Validate file size (max 2MB for images)\n    const maxSize = 2 * 1024 * 1024; // 2MB\n    if (file.size > maxSize) {\n      return res.badRequest({\n        error: 'File too large. Maximum size is 2MB.'\n      });\n    }\n\n    // Process image (e.g., resize, compress)\n    const processedPath = await processImage(file.tmpPath);\n\n    res.json({\n      message: 'Image uploaded successfully',\n      image: {\n        name: file.originalName,\n        size: file.size,\n        type: file.mimeType,\n        path: processedPath\n      }\n    });\n  }\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"file-object-properties",children:"File Object Properties"}),"\n",(0,a.jsx)(n.h3,{id:"file-structure",children:"File Structure"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:'interface FormFile {\n  formName: string;      // The name of the form field\n  mimeType: string;      // MIME type (e.g., "image/png")\n  size: number;          // File size in bytes\n  tmpPath: string;       // Temporary file path\n  originalName: string;  // Original filename with extension\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"accessing-file-properties",children:"Accessing File Properties"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"@post('/file-info')\nasync getFileInfo(req: Request, res: Response) {\n  if (!req.files || req.files.length === 0) {\n    return res.badRequest({ error: 'No file uploaded' });\n  }\n\n  const file = req.files[0];\n\n  res.json({\n    formField: file.formName,\n    originalName: file.originalName,\n    mimeType: file.mimeType,\n    size: file.size,\n    sizeInMB: (file.size / (1024 * 1024)).toFixed(2),\n    temporaryPath: file.tmpPath\n  });\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,a.jsx)(n.h3,{id:"file-too-large",children:"File Too Large"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:'// When a file exceeds maxFileSize\n// Response: 400 Bad Request\n{\n  "error": "File too large",\n  "message": "File \'large-file.zip\' (15MB) exceeds the maximum allowed size of 5MB"\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"no-files-uploaded",children:"No Files Uploaded"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"@post('/upload')\nasync uploadFile(req: Request, res: Response) {\n  if (!req.files || req.files.length === 0) {\n    return res.badRequest({\n      error: 'No file uploaded',\n      message: 'Please select a file to upload'\n    });\n  }\n\n  // Process file...\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"invalid-file-type",children:"Invalid File Type"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"@post('/upload')\nasync uploadFile(req: Request, res: Response) {\n  if (!req.files || req.files.length === 0) {\n    return res.badRequest({ error: 'No file uploaded' });\n  }\n\n  const file = req.files[0];\n  const allowedTypes = ['image/jpeg', 'image/png', 'application/pdf'];\n\n  if (!allowedTypes.includes(file.mimeType)) {\n    return res.badRequest({\n      error: 'Invalid file type',\n      message: `File type '${file.mimeType}' is not allowed. Allowed types: ${allowedTypes.join(', ')}`\n    });\n  }\n\n  // Process file...\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"file-processing-examples",children:"File Processing Examples"}),"\n",(0,a.jsx)(n.h3,{id:"moving-files-to-permanent-location",children:"Moving Files to Permanent Location"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"@post('/upload')\nasync uploadFile(req: Request, res: Response) {\n  if (!req.files || req.files.length === 0) {\n    return res.badRequest({ error: 'No file uploaded' });\n  }\n\n  const file = req.files[0];\n  const permanentPath = await moveFileToPermanentLocation(file.tmpPath, file.originalName);\n\n  res.json({\n    message: 'File uploaded successfully',\n    path: permanentPath\n  });\n}\n\n@post('/image')\nasync uploadImage(req: Request, res: Response) {\n  if (!req.files || req.files.length === 0) {\n    return res.badRequest({ error: 'No image uploaded' });\n  }\n\n  const file = req.files[0];\n  const processedPath = await processImage(file.tmpPath);\n\n  res.json({\n    message: 'Image processed and uploaded',\n    path: processedPath\n  });\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"html-form-examples",children:"HTML Form Examples"}),"\n",(0,a.jsx)(n.h3,{id:"single-file-upload",children:"Single File Upload"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-html",children:'<form action="/upload/single" method="post" enctype="multipart/form-data">\n  <input type="file" name="file" required>\n  <button type="submit">Upload File</button>\n</form>\n'})}),"\n",(0,a.jsx)(n.h3,{id:"multiple-file-upload-1",children:"Multiple File Upload"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-html",children:'<form action="/upload/multiple" method="post" enctype="multipart/form-data">\n  <input type="file" name="files" multiple required>\n  <button type="submit">Upload Files</button>\n</form>\n'})}),"\n",(0,a.jsx)(n.h3,{id:"file-upload-with-form-data-1",children:"File Upload with Form Data"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-html",children:'<form action="/upload/with-data" method="post" enctype="multipart/form-data">\n  <input type="text" name="title" placeholder="File title" required>\n  <textarea name="description" placeholder="File description"></textarea>\n  <select name="category">\n    <option value="document">Document</option>\n    <option value="image">Image</option>\n    <option value="video">Video</option>\n  </select>\n  <input type="file" name="file" required>\n  <button type="submit">Upload</button>\n</form>\n'})})]})}function c(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>o});var l=i(6540);const a={},s=l.createContext(a);function t(e){const n=l.useContext(s);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),l.createElement(s.Provider,{value:n},e.children)}}}]);