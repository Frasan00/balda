"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[603],{1210:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>i,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"core-concepts/controllers","title":"Controllers","description":"Controllers are the heart of your Balda application. They organize your route handlers into logical groups and provide a clean, decorator-based API for defining HTTP endpoints.","source":"@site/docs/core-concepts/controllers.md","sourceDirName":"core-concepts","slug":"/core-concepts/controllers","permalink":"/balda/docs/core-concepts/controllers","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/balda/tree/main/docs/docs/core-concepts/controllers.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docs","previous":{"title":"Server","permalink":"/balda/docs/core-concepts/server"},"next":{"title":"Routing","permalink":"/balda/docs/core-concepts/routing"}}');var o=n(4848),l=n(8453);const t={sidebar_position:2},i="Controllers",a={},d=[{value:"Basic Controller",id:"basic-controller",level:2},{value:"Controller Decorator",id:"controller-decorator",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Examples",id:"examples",level:3},{value:"HTTP Method Decorators",id:"http-method-decorators",level:2},{value:"Route Options",id:"route-options",level:2},{value:"Available Options",id:"available-options",level:3},{value:"Validation and Serialization",id:"validation-and-serialization",level:2},{value:"Request Validation",id:"request-validation",level:3},{value:"Response Serialization",id:"response-serialization",level:3},{value:"Serialize Options",id:"serialize-options",level:3},{value:"Controller-Level Middleware",id:"controller-level-middleware",level:2},{value:"Complete Controller Example",id:"complete-controller-example",level:2},{value:"Controller Organization",id:"controller-organization",level:2},{value:"File Structure",id:"file-structure",level:3},{value:"Controller Registration",id:"controller-registration",level:3},{value:"Controller Index",id:"controller-index",level:3},{value:"Best Practices",id:"best-practices",level:2}];function c(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.header,{children:(0,o.jsx)(r.h1,{id:"controllers",children:"Controllers"})}),"\n",(0,o.jsx)(r.p,{children:"Controllers are the heart of your Balda application. They organize your route handlers into logical groups and provide a clean, decorator-based API for defining HTTP endpoints."}),"\n",(0,o.jsx)(r.h2,{id:"basic-controller",children:"Basic Controller"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"import { controller, get, post } from 'balda';\nimport { Request, Response } from 'balda';\n\n@controller('/users')\nexport class UsersController {\n  @get('/')\n  async getAllUsers(req: Request, res: Response) {\n    res.json({ users: [] });\n  }\n\n  @post('/')\n  async createUser(req: Request, res: Response) {\n    res.created(req.body);\n  }\n}\n"})}),"\n",(0,o.jsx)(r.h2,{id:"controller-decorator",children:"Controller Decorator"}),"\n",(0,o.jsxs)(r.p,{children:["The ",(0,o.jsx)(r.code,{children:"@controller()"})," decorator marks a class as a controller and defines the base path for all routes within that controller."]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"@controller(path?: string, swaggerOptions?: SwaggerRouteOptions)\n"})}),"\n",(0,o.jsx)(r.h3,{id:"parameters",children:"Parameters"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"path"})," (optional): Base path for all routes in the controller"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"swaggerOptions"})," (optional): Swagger documentation options for the controller"]}),"\n"]}),"\n",(0,o.jsx)(r.h3,{id:"examples",children:"Examples"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"// Simple controller\n@controller('/users')\nexport class UsersController {}\n\n// Controller with Swagger options\n@controller('/users', {\n  tags: ['Users'],\n  summary: 'User management endpoints'\n})\nexport class UsersController {}\n"})}),"\n",(0,o.jsx)(r.h2,{id:"http-method-decorators",children:"HTTP Method Decorators"}),"\n",(0,o.jsx)(r.p,{children:"Balda provides decorators for all HTTP methods:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"@controller('/users')\nexport class UsersController {\n  @get('/')\n  getAll(req, res) {\n    res.json({ users: [] });\n  }\n\n  @get('/:id')\n  getById(req, res) {\n    res.json({ user: { id: req.params.id } });\n  }\n\n  @post('/')\n  create(req, res) {\n    res.created(req.body);\n  }\n\n  @put('/:id')\n  update(req, res) {\n    res.json({ id: req.params.id, ...req.body });\n  }\n\n  @patch('/:id')\n  partialUpdate(req, res) {\n    res.json({ id: req.params.id, ...req.body });\n  }\n\n  @del('/:id')\n  delete(req, res) {\n    res.noContent();\n  }\n}\n"})}),"\n",(0,o.jsx)(r.h2,{id:"route-options",children:"Route Options"}),"\n",(0,o.jsx)(r.p,{children:"HTTP method decorators accept various options:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"// Middleware\n@get('/', { middleware: [authMiddleware] })\ngetAll(req, res) { res.json({ users: [] }); }\n\n// Body type for file uploads or form data\n@post('/upload', { bodyType: 'form-data' })\nupload(req, res) {\n  const file = req.file('fieldName');\n  res.ok({ filename: file.originalName });\n}\n\n// URL-encoded form data\n@post('/form', { bodyType: 'urlencoded' })\nhandleForm(req, res) { res.ok(req.body); }\n\n// Swagger documentation\n@get('/', {\n  swagger: {\n    summary: 'Get all users',\n    description: 'Retrieve a list of all users'\n  }\n})\ngetAll(req, res) { res.json({ users: [] }); }\n"})}),"\n",(0,o.jsx)(r.h3,{id:"available-options",children:"Available Options"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"middleware"}),": Middleware array for this route"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"bodyType"}),": ",(0,o.jsx)(r.code,{children:"'json'"})," | ",(0,o.jsx)(r.code,{children:"'urlencoded'"})," | ",(0,o.jsx)(r.code,{children:"'form-data'"})," (default: ",(0,o.jsx)(r.code,{children:"'json'"}),")"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"swagger"}),": OpenAPI documentation metadata"]}),"\n"]}),"\n",(0,o.jsx)(r.h2,{id:"validation-and-serialization",children:"Validation and Serialization"}),"\n",(0,o.jsxs)(r.p,{children:["Balda supports ",(0,o.jsx)(r.strong,{children:"Zod"}),", ",(0,o.jsx)(r.strong,{children:"TypeBox"}),", and ",(0,o.jsx)(r.strong,{children:"OpenAPI/AJV"})," schemas for validation and serialization:"]}),"\n",(0,o.jsx)(r.h3,{id:"request-validation",children:"Request Validation"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"import { z } from 'zod';\nimport { Type } from '@sinclair/typebox';\n\nconst CreateUserSchema = z.object({\n  name: z.string().min(1),\n  email: z.string().email(),\n});\n\n// Or with TypeBox\nconst CreateUserTypeBox = Type.Object({\n  name: Type.String({ minLength: 1 }),\n  email: Type.String({ format: 'email' }),\n});\n\n// Or with OpenAPI/AJV\nconst CreateUserOpenApi = {\n  type: 'object',\n  properties: {\n    name: { type: 'string' },\n    email: { type: 'string', format: 'email' },\n  },\n  required: ['name', 'email'],\n} as const;\n\n@controller('/users')\nexport class UsersController {\n  @post('/')\n  @validate.body(CreateUserSchema)  // Body validation\n  create(req, res, body) {\n    // body is validated and typed\n    res.created(body);\n  }\n\n  @get('/')\n  @validate.query(z.object({ page: z.string().optional() }))  // Query validation\n  getAll(req, res, query) {\n    // query is validated\n    res.json({ users: [], page: query.page });\n  }\n}\n"})}),"\n",(0,o.jsx)(r.h3,{id:"response-serialization",children:"Response Serialization"}),"\n",(0,o.jsxs)(r.p,{children:["Multiple ",(0,o.jsx)(r.code,{children:"@serialize"})," decorators can be stacked for different status codes:"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"const UserSchema = z.object({\n  id: z.number(),\n  name: z.string(),\n  email: z.string(),\n});\n\nconst ErrorSchema = z.object({\n  error: z.string(),\n});\n\n@controller('/users')\nexport class UsersController {\n  @get('/:id')\n  @serialize(UserSchema)  // Default 200 response\n  @serialize(ErrorSchema, { status: 404 })  // 404 response\n  getById(req, res) {\n    const user = findUser(req.params.id);\n    user ? res.json(user) : res.notFound({ error: 'Not found' });\n  }\n\n  @post('/')\n  @serialize(UserSchema, { status: 201 })  // Success response\n  @serialize(ErrorSchema, { status: 409 })  // Conflict response\n  @serialize(ErrorSchema, { status: 400, throwErrorOnValidationFail: true })  // Validation enabled\n  create(req, res, body) {\n    res.created(body);\n  }\n}\n"})}),"\n",(0,o.jsx)(r.h3,{id:"serialize-options",children:"Serialize Options"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"status"}),": HTTP status code for this schema (default: 200)"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"throwErrorOnValidationFail"}),": Whether to validate the response and throw on mismatch (default: false)"]}),"\n"]}),"\n",(0,o.jsx)(r.h2,{id:"controller-level-middleware",children:"Controller-Level Middleware"}),"\n",(0,o.jsx)(r.p,{children:"Apply middleware to all routes in a controller:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"@controller('/users')\n@middleware(authMiddleware)\nexport class UsersController {\n  @get('/')\n  getAll(req, res) {\n    // Uses authMiddleware\n    res.json({ users: [] });\n  }\n\n  @get('/public')\n  @middleware(publicMiddleware) // Override\n  getPublic(req, res) {\n    // Uses publicMiddleware instead\n    res.json({ users: [] });\n  }\n}\n"})}),"\n",(0,o.jsx)(r.h2,{id:"complete-controller-example",children:"Complete Controller Example"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"import { controller, get, post, put, del, middleware, validate, serialize } from 'balda';\nimport { z } from 'zod';\n\nconst CreateUserSchema = z.object({\n  name: z.string(),\n  email: z.string().email()\n});\n\nconst UserSchema = z.object({\n  id: z.number(),\n  name: z.string(),\n  email: z.string()\n});\n\n@controller('/users')\n@middleware(loggerMiddleware)\nexport class UsersController {\n  private users = [\n    { id: 1, name: 'Alice', email: 'alice@example.com' }\n  ];\n\n  @get('/')\n  @serialize(z.array(UserSchema))\n  getAll(req, res) {\n    res.json(this.users);\n  }\n\n  @get('/:id')\n  @serialize(UserSchema)\n  getById(req, res) {\n    const user = this.users.find(u => u.id === Number(req.params.id));\n    user ? res.json(user) : res.notFound({ error: 'User not found' });\n  }\n\n  @post('/')\n  @validate.body(CreateUserSchema)\n  @serialize(UserSchema)\n  create(req, res, body) {\n    const user = { id: this.users.length + 1, ...body };\n    this.users.push(user);\n    res.created(user);\n  }\n\n  @put('/:id')\n  @middleware(authMiddleware)\n  @validate.body(CreateUserSchema)\n  update(req, res, body) {\n    const id = Number(req.params.id);\n    const index = this.users.findIndex(u => u.id === id);\n\n    if (index === -1) {\n      return res.notFound({ error: 'User not found' });\n    }\n\n    this.users[index] = { ...this.users[index], ...body };\n    res.json(this.users[index]);\n  }\n\n  @del('/:id')\n  @middleware(authMiddleware)\n  delete(req, res) {\n    const id = Number(req.params.id);\n    const index = this.users.findIndex(u => u.id === id);\n\n    if (index === -1) {\n      return res.notFound({ error: 'User not found' });\n    }\n\n    this.users.splice(index, 1);\n    res.noContent();\n  }\n}\n"})}),"\n",(0,o.jsx)(r.h2,{id:"controller-organization",children:"Controller Organization"}),"\n",(0,o.jsx)(r.h3,{id:"file-structure",children:"File Structure"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{children:"src/\n\u251c\u2500\u2500 controllers/\n\u2502   \u251c\u2500\u2500 users.controller.ts\n\u2502   \u251c\u2500\u2500 posts.controller.ts\n\u2502   \u251c\u2500\u2500 auth.controller.ts\n\u2502   \u2514\u2500\u2500 index.ts\n"})}),"\n",(0,o.jsx)(r.h3,{id:"controller-registration",children:"Controller Registration"}),"\n",(0,o.jsx)(r.p,{children:"Controllers are automatically registered when the server starts. Make sure your controller files match the patterns specified in your server configuration:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"const server = new Server({\n  controllerPatterns: ['./src/controllers/**/*.ts']\n});\n"})}),"\n",(0,o.jsx)(r.h3,{id:"controller-index",children:"Controller Index"}),"\n",(0,o.jsx)(r.p,{children:"You can create an index file to export all controllers:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"// src/controllers/index.ts\nexport * from './users.controller';\nexport * from './posts.controller';\nexport * from './auth.controller';\n"})}),"\n",(0,o.jsx)(r.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,o.jsxs)(r.ol,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Single Responsibility"})," - One controller per resource or feature"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Consistent Naming"})," - Use clear, descriptive names (e.g., ",(0,o.jsx)(r.code,{children:"UsersController"}),", ",(0,o.jsx)(r.code,{children:"AuthController"}),")"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Use Validation"})," - Always validate request bodies with ",(0,o.jsx)(r.code,{children:"@validate.body()"})]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Use Serialization"})," - Define response schemas with ",(0,o.jsx)(r.code,{children:"@serialize()"})," for type safety"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Middleware Placement"})," - Apply auth/logging at controller level, specific checks at route level"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Error Handling"})," - Return appropriate HTTP status codes (",(0,o.jsx)(r.code,{children:"notFound"}),", ",(0,o.jsx)(r.code,{children:"badRequest"}),", etc.)"]}),"\n"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"// Good example combining best practices\n@controller('/users')\n@middleware(loggerMiddleware)\nexport class UsersController {\n  @post('/')\n  @validate.body(CreateUserSchema)\n  @serialize(UserSchema)\n  create(req, res, body) {\n    const user = userService.create(body);\n    res.created(user);\n  }\n}\n"})})]})}function p(e={}){const{wrapper:r}={...(0,l.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>t,x:()=>i});var s=n(6540);const o={},l=s.createContext(o);function t(e){const r=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),s.createElement(l.Provider,{value:r},e.children)}}}]);